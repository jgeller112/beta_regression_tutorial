<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jason Geller">
<meta name="author" content="Robert Kubinec">
<meta name="author" content="Matti Vuorre">
<meta name="author" content="Chelsea M. Parlett Pelleriti">
<meta name="keywords" content="beta regression, R, tutorial, psychology, learning and memory">
<meta name="description" content="BETA REGRESSION TUTORIAL">

<title>A Beta Way: A Tutorial For Using Beta Regression in Pychological Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="ms_files/libs/clipboard/clipboard.min.js"></script>
<script src="ms_files/libs/quarto-html/quarto.js"></script>
<script src="ms_files/libs/quarto-html/popper.min.js"></script>
<script src="ms_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="ms_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ms_files/libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ms_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ms_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ms_files/libs/bootstrap/bootstrap-2e38c3ced9773c6e22f87e803f5f4c77.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="_extensions/wjschne/apaquarto/apa.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivating-example" id="toc-motivating-example" class="nav-link active" data-scroll-target="#motivating-example">Motivating Example</a>
  <ul class="collapse">
  <li><a href="#data-and-methods" id="toc-data-and-methods" class="nav-link" data-scroll-target="#data-and-methods">Data and Methods</a></li>
  <li><a href="#reanalysis-of-wilford-et-al.-experiment-1a" id="toc-reanalysis-of-wilford-et-al.-experiment-1a" class="nav-link" data-scroll-target="#reanalysis-of-wilford-et-al.-experiment-1a">Reanalysis of Wilford et al.&nbsp;Experiment 1A</a>
  <ul class="collapse">
  <li><a href="#glm-approach" id="toc-glm-approach" class="nav-link" data-scroll-target="#glm-approach">GLM Approach</a></li>
  <li><a href="#bayesian-regression" id="toc-bayesian-regression" class="nav-link" data-scroll-target="#bayesian-regression">Bayesian Regression</a></li>
  <li><a href="#beta-regression-1" id="toc-beta-regression-1" class="nav-link" data-scroll-target="#beta-regression-1">Beta Regression</a></li>
  <li><a href="#model-parameters" id="toc-model-parameters" class="nav-link" data-scroll-target="#model-parameters">Model Parameters</a></li>
  <li><a href="#mean-mu-parameter" id="toc-mean-mu-parameter" class="nav-link" data-scroll-target="#mean-mu-parameter">Mean <span class="math inline">\mu</span> parameter</a></li>
  <li><a href="#precision-phi-component" id="toc-precision-phi-component" class="nav-link" data-scroll-target="#precision-phi-component">Precision (<span class="math inline">\phi</span>) Component</a></li>
  <li><a href="#posterior-predictive-check" id="toc-posterior-predictive-check" class="nav-link" data-scroll-target="#posterior-predictive-check">Posterior Predictive Check</a></li>
  </ul></li>
  <li><a href="#zero-inflated-beta-zib-regression" id="toc-zero-inflated-beta-zib-regression" class="nav-link" data-scroll-target="#zero-inflated-beta-zib-regression">Zero-Inflated Beta (ZIB) Regression</a>
  <ul class="collapse">
  <li><a href="#predicted-probabilities-and-marginal-effects" id="toc-predicted-probabilities-and-marginal-effects" class="nav-link" data-scroll-target="#predicted-probabilities-and-marginal-effects">Predicted Probabilities and Marginal Effects</a></li>
  <li><a href="#zero-inflated-alpha" id="toc-zero-inflated-alpha" class="nav-link" data-scroll-target="#zero-inflated-alpha">Zero-Inflated (<span class="math inline">\alpha</span>)</a></li>
  </ul></li>
  <li><a href="#zero-one-inflated-beta-zoib" id="toc-zero-one-inflated-beta-zoib" class="nav-link" data-scroll-target="#zero-one-inflated-beta-zoib">Zero-One-Inflated Beta (ZOIB)</a>
  <ul class="collapse">
  <li><a href="#model-parameters-1" id="toc-model-parameters-1" class="nav-link" data-scroll-target="#model-parameters-1">Model Parameters</a></li>
  <li><a href="#predictions-and-marginal-effects" id="toc-predictions-and-marginal-effects" class="nav-link" data-scroll-target="#predictions-and-marginal-effects">Predictions and Marginal Effects</a></li>
  </ul></li>
  <li><a href="#ordered-beta-regression" id="toc-ordered-beta-regression" class="nav-link" data-scroll-target="#ordered-beta-regression">Ordered Beta Regression</a>
  <ul class="collapse">
  <li><a href="#fitting-an-ordered-beta-regression" id="toc-fitting-an-ordered-beta-regression" class="nav-link" data-scroll-target="#fitting-an-ordered-beta-regression">Fitting an Ordered Beta Regression</a></li>
  </ul></li>
  <li><a href="#model-parameters-2" id="toc-model-parameters-2" class="nav-link" data-scroll-target="#model-parameters-2">Model Parameters</a>
  <ul class="collapse">
  <li><a href="#mean-mu-1" id="toc-mean-mu-1" class="nav-link" data-scroll-target="#mean-mu-1">Mean (<span class="math inline">\mu</span>)</a></li>
  <li><a href="#dispersion-phi-1" id="toc-dispersion-phi-1" class="nav-link" data-scroll-target="#dispersion-phi-1">Dispersion (<span class="math inline">\phi</span>)</a></li>
  <li><a href="#cutpoints" id="toc-cutpoints" class="nav-link" data-scroll-target="#cutpoints">Cutpoints</a></li>
  <li><a href="#ordered-beta-regression-model-fit" id="toc-ordered-beta-regression-model-fit" class="nav-link" data-scroll-target="#ordered-beta-regression-model-fit">Ordered Beta Regression Model Fit</a></li>
  <li><a href="#ordered-beta-scale" id="toc-ordered-beta-scale" class="nav-link" data-scroll-target="#ordered-beta-scale">Ordered Beta Scale</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="../ms.pdf"><i class="bi bi-file-pdf"></i>PDF (apaquarto)</a></li><li><a href="ms.docx"><i class="bi bi-file-word"></i>MS Word (apaquarto)</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">




<br>

<br>

<section id="title" class="level1 title unnumbered unlisted">
<h1 class="title unnumbered unlisted">A Beta Way: A Tutorial For Using Beta Regression in Pychological Research</h1>
<div class="Author">
<br>

<p>Jason Geller<sup>1</sup>, Robert Kubinec<sup>2</sup>, Matti Vuorre<sup>3</sup>, and Chelsea M. Parlett Pelleriti<sup>4</sup></p>
<p><sup>1</sup>Department of Psychology and Neuroscience, Boston College</p>
<p><sup>2</sup>University of South Carolina</p>
<p><sup>3</sup>Tilburg University</p>
<p><sup>4</sup>School</p>
</div>
<br>

<br>

</section>
<section id="author-note" class="level1 unnumbered unlisted AuthorNote">
<h1 class="unnumbered unlisted AuthorNote">Author Note</h1>
<p>Jason Geller <img src="_extensions/wjschne/apaquarto/ORCID-iD_icon-vector.svg" id="orchid" class="img-fluid" style="width:4.23mm" alt="Orcid ID Logo: A green circle with white letters ID"> <a href="https://orcid.org/0000-0002-7459-4505">https://orcid.org/0000-0002-7459-4505</a></p>
<p>Robert Kubinec <img src="_extensions/wjschne/apaquarto/ORCID-iD_icon-vector.svg" id="orchid" class="img-fluid" style="width:4.23mm" alt="Orcid ID Logo: A green circle with white letters ID"> <a href="https://orcid.org/0000-0002-7459-4505">https://orcid.org/0000-0002-7459-4505</a></p>
<p>Matti Vuorre <img src="_extensions/wjschne/apaquarto/ORCID-iD_icon-vector.svg" id="orchid" class="img-fluid" style="width:4.23mm" alt="Orcid ID Logo: A green circle with white letters ID"> <a href="https://orcid.org/0000-0002-7459-4505">https://orcid.org/0000-0002-7459-4505</a></p>
<p>Chelsea M. Parlett Pelleriti <img src="_extensions/wjschne/apaquarto/ORCID-iD_icon-vector.svg" id="orchid" class="img-fluid" style="width:4.23mm" alt="Orcid ID Logo: A green circle with white letters ID"> <a href="https://orcid.org/0000-0001-9301-1398">https://orcid.org/0000-0001-9301-1398</a></p>
<p>Correspondence concerning this article should be addressed to Jason Geller, Department of Psychology and Neuroscience, Boston College, McGuinn 300, Chestnut Hill, MA 2467, USA, Email: <a href="mailto:drjasongeller@gmail.com">drjasongeller@gmail.com</a></p>
<br>
</section>
<section id="abstract" class="level1 unnumbered unlisted AuthorNote">
<h1 class="unnumbered unlisted AuthorNote">Abstract</h1>
<div class="AbstractFirstParagraph">
<p>Rates, percentages, and proportions are common in psychology and the social sciences, and usually treated as normally distributed. This practice, however, ignores salient features in the data, such as its natural limits at 0 and 1, and can thus lead to distorted estimates. Treating such outcomes as beta-distributed, instead, acknowledges these salient features and therefore leads to more accurate estimates. The adoption of such models remains limited, however. Our purpose is to guide researchers in using the beta distribution through illustrative analyses of a real example from the psychological literature. First, we introduce the beta distribution and the beta regression model highlighting crucial components and assumptions. Second, we show how to conduct a beta regression in R using an example dataset from the learning and memory literature. We then discuss extensions of the beta model, such as zero-inflated, zero- and one-inflated, and ordered beta models. To facilitate these analyses’ more widespread adoption, we present a detailed code supplement at https://github.com/jgeller112/beta_regression_tutorial.</p>
</div>
<p><em>Keywords</em>: beta regression, R, tutorial, psychology, learning and memory</p>
<br>
</section>
<section id="firstheader" class="level1 title unnumbered unlisted">
<h1 class="title unnumbered unlisted">A Beta Way: A Tutorial For Using Beta Regression in Pychological Research</h1>
<p>In psychological research, it is common to measure performance (on a test or task), attitudes, and choices using outcomes expressed as proportions or percentages. To illustrate this in a practical context, consider a memory experiment in which participants read a short passage on a specific topic. After a brief distractor task, they complete a final memory test consisting of 10 short-answer questions, each assigned a different point value (e.g., question 1 might be worth 4 points, while question 2 might be worth 1 point). In this scenario, the primary focus is on the total number of points earned relative to the total possible points across all questions.</p>
<p>An important question arises: how do we analyze this type of data? In psychological research, proportional outcomes are frequently analyzed with methods that fall under the general or generalized linear (G/GLM) frameworks. General linear models assume normal distributions, such as t-tests and ANOVAs while generalized models assume non-normal distributions, with logistic regression being a common example.</p>
<p>One popular tool for estimation and hypothesis testing that most readers will be familiar with is ordinary least squares (OLS) regression. OLS regression assumes our response outcome is normal in nature. With our example above, we could calculate the proportion or percentage correct for each question (or overall performance) and submit it to a regression analysis. While this is a very popular approach in psychology and is used quite frequently <span class="citation" data-cites="sladekova2024unicorns">(<a href="#ref-sladekova2024unicorns" role="doc-biblioref">Sladekova &amp; Field, 2024</a>)</span>, OLS regression makes several key assumptions that make it not ideal for the data we have. These assumptions include (1) a linear and additive relationship between predictors and outcomes, (2) normally distributed errors with a mean of zero and constant variance, and (3) homoscedasticity. When these assumptions are met, OLS regression provides unbiased and reliable estimates. However, when dealing with proportional data, several of these assumptions are often violated due to their bounded nature (0 to 1) and tendency to exhibit non-constant variance <span class="citation" data-cites="ferrari2004 paolino2001">(<a href="#ref-ferrari2004" role="doc-biblioref">Ferrari &amp; Cribari-Neto, 2004</a>; <a href="#ref-paolino2001" role="doc-biblioref">Paolino, 2001</a>)</span>. This makes OLS regression an unsuitable choice for such data.</p>
<p>Another popular tool for estimation and hypothesis testing with proportional data is logistic regression. In our example, we could model accuracy as the ratio of successes to failures—specifically, the number of correct responses relative to the total for each question. While this approach might seem appropriate, it presents several challenges when dealing with data near the boundaries of 0 and 1, which is a common characteristic of proportional or percentage outcomes in psychological research.</p>
<p>One major issue with this approach is boundary inflation, which refers to the inflated estimates that occur when data clusters too closely at the extremes of 0 or 1. Binomial models assume probabilities strictly between 0 and 1, and this assumption can lead to biased estimates, especially when a substantial proportion of responses cluster near the boundaries. Additionally, as proportions approach these extremes, variance decreases, resulting in overly narrow confidence intervals and an underestimation of variability. Real-world data often exhibit greater variability than what the binomial model can accommodate, leading to overdispersion that can distort statistical inferences. Moreover, the bounded nature of proportions complicates their interpretation within a binomial framework.</p>
<p>This discussion highlights the importance of selecting statistical models that accurately reflect the characteristics of your data. Choosing an inappropriate model can lead to misleading conclusions—for instance, failing to detect genuine effects (Type II errors) or falsely identifying effects that do not exist (Type I errors). To ensure valid and reliable inferences, researchers must carefully consider the structure of their data and the assumptions underlying their chosen models.</p>
<p>The challenges of analyzing proportional data are not new <span class="citation" data-cites="bartlett1936">(see <a href="#ref-bartlett1936" role="doc-biblioref">Bartlett, 1936</a>)</span>. Fortunately, several alternative approaches address the limitations of commonly used models. One such approach is Beta regression, an extension of the generalized linear model that employs the Beta distribution (described in-depth below) <span class="citation" data-cites="ferrari2004 paolino2001">(<a href="#ref-ferrari2004" role="doc-biblioref">Ferrari &amp; Cribari-Neto, 2004</a>; <a href="#ref-paolino2001" role="doc-biblioref">Paolino, 2001</a>)</span>. Beta regression offers a flexible and robust solution for modeling proportional data by accounting for boundary effects and overdispersion, making it a valuable alternative to traditional binomial models. This approach is particularly well-suited for psychological research because it can handle both the bounded nature of proportional data and the non-constant variance often encountered in these datasets.</p>
<section id="a-beginners-guide-to-beta-regression" class="level2">
<h2 data-anchor-id="a-beginners-guide-to-beta-regression">A Beginners Guide to Beta Regression</h2>
<p>With the combination of open-source programming languages like R <span class="citation" data-cites="R">(<a href="#ref-R" role="doc-biblioref">R Core Team, 2024</a>)</span> and the great community of package developers, it is becoming trivial to run analyses like Beta regression. However, adoption of these methods, especially in psychology, is sparse. One reason for the lack of adaptation could be the lack of resources available to wider community. However, this is slowly changing with a great blog posts by <span class="citation" data-cites="heiss2021">Heiss (<a href="#ref-heiss2021" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="vuorre2019">Vuorre (<a href="#ref-vuorre2019" role="doc-biblioref">2019</a>)</span>, and <span class="citation" data-cites="bendixen2023">Bendixen and Purzycki (<a href="#ref-bendixen2023" role="doc-biblioref">2023</a>)</span>, and some excellent tutorial papers <span class="citation" data-cites="coretta2025bayesian">(see <a href="#ref-coretta2025bayesian" role="doc-biblioref">Coretta &amp; Bürkner, 2025</a>)</span>. This tutorial hopes to expand upon these resources and provide psychologists with the tools and code needed to explore other statistical options in their research.</p>
<p>In this tutorial, we plan to (a) give a brief, non-technical overview of the principles underlying beta regression (keeping mathematics notation to a minimum), (b) walk-through an empirical example of applying beta regression in the popular R programming language and (c) highlight the the extensions which are most relevant to researchers in psychology (e.g., zero-inflated, zero-one-inflated, and ordered beta regressions).</p>
<p>In this article, we try to limit code where possible; however, the online version has all the code needed to reproduce all analyses herein. Furthermore, to promote transparency and reproduciblity, the tutorial was written in R version 4.4.3 (<span class="citation" data-cites="R">R Core Team (<a href="#ref-R" role="doc-biblioref">2024</a>)</span>) using Quarto (v.1.5.54), an open-source publishing system that allows for dynamic and static documents. This allows figures, tables, and text to be programmatically included directly in the manuscript, ensuring that all results are seamlessly integrated into the document. In addition, we use the <code>rix</code> <span class="citation" data-cites="rix">(<a href="#ref-rix" role="doc-biblioref">Rodrigues &amp; Baumann, 2025</a>)</span> R package which harnesses the power of the <code>nix</code> <span class="citation" data-cites="nix">(<a href="#ref-nix" role="doc-biblioref">Dolstra &amp; contributors, 2006</a>)</span> ecosystem to to help with computational reproducibility. Not only does this give us a snapshot of the packages used to create the current manuscript, but it also takes a snapshot of system dependencies used at run-time. This way reproducers can easily re-use the exact same environment by installing the <code>nix</code> package manager and using the included default.nix file to set up the right environment. The README file in the GitHub repository contains detailed information on how to set this up to reproduce the contents of the current manuscript, including a video.</p>
<p>Beta regression can be estimated using various tools and approached from either a frequentist or Bayesian perspective. We adopt a Bayesian framework primarily due to its practicality and the availability of advanced computational techniques ([<span class="citation" data-cites="gelman2013bayesian">Gelman et al. (<a href="#ref-gelman2013bayesian" role="doc-biblioref">2013</a>)</span>; <span class="citation" data-cites="mcelreath2020statistical">McElreath (<a href="#ref-mcelreath2020statistical" role="doc-biblioref">2020</a>)</span>; <span class="citation" data-cites="bayes_rules">Johnson et al. (<a href="#ref-bayes_rules" role="doc-biblioref">n.d.</a>)</span>). However, similar implementations are available within the frequentist framework (see supplemental materials).</p>
<p>In this paper, we demonstrate how to implement Beta regression models and their extensions using the brms <span class="citation" data-cites="brms">(<a href="#ref-brms" role="doc-biblioref">Bürkner, 2017</a>)</span> package. Additionally, we leverage the powerful <code>marginaleffects</code> <span class="citation" data-cites="margeffects2024">(<a href="#ref-margeffects2024" role="doc-biblioref">Arel-Bundock et al., 2024</a>)</span> package to extract meaningful estimates. We believe this combination provides an effective and efficient approach to performing beta regression, ensuring robust and interpretable results.</p>
</section>
<section id="beta-distribution" class="level2">
<h2 data-anchor-id="beta-distribution">Beta Distribution</h2>
<p>Proportional data are bounded between 0 and 1 and often display heteroscedasticity. Common distributions that fall under the G/GLM often do a poor job of capturing this, necessitating the need to fit a different model to the data. For any statistical model, there are two main components: a random component that specifies the distribution of the response variable around its expected value (such as a Poisson or binomial, which are part of the exponential family), a linear predictor that combines explanatory variables in a linear form, and a link function that connects the mean of the response variable to the linear predictor (also referred to as the expected value) <span class="citation" data-cites="nelder1972">(<a href="#ref-nelder1972" role="doc-biblioref">Nelder &amp; Wedderburn, 1972</a>)</span>.</p>
<p>To deal with proportional data, we can fit a model with a Beta distribution <span class="citation" data-cites="ferrari2004">(<a href="#ref-ferrari2004" role="doc-biblioref">Ferrari &amp; Cribari-Neto, 2004</a>)</span>. The Beta distribution has some desirable characteristics that make it ideal for analyzing proportions: It is continuous, it is limited to numbers that fall between 0 and 1, and it highly flexible—it can take on a number of different distribution shapes. The shape which comprises the location, skew, and spread of the distribution are controlled by two parameters: <em>shape1</em> and <em>shape2</em>. <code>Shape 1</code> is sometimes called <span class="math inline">\alpha</span> and <code>shape 2</code> is sometimes called <span class="math inline">\beta</span>. Together these two parameters shape the density curve of the distribution. To highlight this, let’s suppose a participant got 4 out of 6 on a short answer question on a test. We can take the number of correct on that particular test item (4) and divide that by the number of correct (4) + number of incorrect (2) and plot the resulting density curve. Shape1 in this example would be 4 (number of points received or successes). <code>Shape2</code> would be 2–the number of points not received (number of failures). Looking at <a href="#fig-beta-dist" class="quarto-xref" aria-expanded="false">Figure&nbsp;1</a> (A) we see the distribution for one of our questions is shifted towards one indicating higher accuracy on the exam. If we reversed the values of the two parameters <a href="#fig-beta-dist" class="quarto-xref" aria-expanded="false">Figure&nbsp;1</a> (B), we would get a distribution shifted towards 0, indicating a lower accuracy. By adjusting the values of two parameters, we can get a wide range of distributions (e.g., u-shaped, inverted u-shaped , normal, or uniform). In mathematical statistics, the beta distribution is known as the distribution for probabilities because probabilities are bounded but can never equal 0 or 1.</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-beta-dist" class="quarto-float quarto-figure quarto-figure-center" data-fignum="1" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-beta-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;1</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>A. beta distribution with 4 correct and 2 incorrect responses on one test question. B. beta distribution with 2 correct and 4 incorrect responses on one test question</p>
</div>
</figcaption>
<div aria-describedby="fig-beta-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-beta-dist-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>To make abundantly clear what the beta distribution is let’s look at a political example. For example, suppose we want to come up with our best guess of how Donald Trump might do in the 2024 presidential election given his performance in the 2020 election in terms of the number of electoral college votes he received (which are roughly proportional to the popular vote for president in the United States). In that case, we could use the beta distribution to get a sense of our uncertainty in that statement by plugging in 232 for the number of elector college votes Trump won in 2020 for α and 306 for the number of electoral college votes that Trump didn’t win for <span class="math inline">\beta</span>–i.e., all the electoral college votes Joe Biden won in 2020.</p>
</div>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-trump1" class="quarto-float quarto-figure quarto-figure-center" data-fignum="2" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-trump1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;2</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Density Plot of Electorial College Votes</p>
</div>
</figcaption>
<div aria-describedby="fig-trump1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-trump1-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>What <a href="#fig-trump1" class="quarto-xref" aria-expanded="false">Figure&nbsp;2</a> above shows is the range around the proportion of electors that Trump could win in 2024 if we use his 2020 performance as our prior knowledge. We would expect, based on chance alone, for his 2024 total to vary between 40% of electors to 48% of electors. In other words, he would be likely to still lose, but he could get a lot closer to a majority of electoral college votes. If we increase the sample size, say by including how many electoral votes Trump won in 2016 (304 out of 531), our uncertainty would decrease:</p>
</div>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-trump2" class="quarto-float quarto-figure quarto-figure-center" data-fignum="3" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-trump2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;3</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Density Plot of Electors</p>
</div>
</figcaption>
<div aria-describedby="fig-trump2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-trump2-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>The plausible range of percentages/probabilities of <a href="#fig-trump2" class="quarto-xref" aria-expanded="false">Figure&nbsp;3</a> is now within 48% to 52% as taking into account Trump’s 2016 results increases our sample size while also increasing our most likely estimate of his 2024 performance. Importantly, the beta distribution respects bounds.</p>
</div>
<p>Suppose, for example, that we only expect Trump to win 1 out of 538 electors. That would concentrate a substantial amount of plausible values at the lower end of the range of the variable:</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-trump0" class="quarto-float quarto-figure quarto-figure-center" data-fignum="4" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-trump0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;4</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Density Plot of Electors</p>
</div>
</figcaption>
<div aria-describedby="fig-trump0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-trump0-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>What we can see in <a href="#fig-trump0" class="quarto-xref" aria-expanded="false">Figure&nbsp;4</a> is a unique feature of the beta distribution: it respects upper and lower bounds. Here the beta distribution says it is most likely Trump wins a very small number of electoral college votes– below 1% of them – but it is plausible that he still wins more than 1%. It is impossible, as it should be, for Trump to win less than 0% of electors.</p>
</div>
<section id="mean-and-precision" class="level3">
<h3 data-anchor-id="mean-and-precision">Mean and Precision</h3>
<p>When talking about beta regression, instead of shape1 and shape2 or <span class="math inline">\alpha</span> or <span class="math inline">\beta</span> we talk about <span class="math inline">\mu</span> and <span class="math inline">\phi</span>, where <span class="math inline">\mu</span> represents the mean or average, and <span class="math inline">\phi</span> represents the precision, in a roughly analogous way to how the Normal distribution has a mean and variance. We can reparameterize <span class="math inline">\alpha</span> and <span class="math inline">\beta</span> into <span class="math inline">\mu</span> and <span class="math inline">\phi</span> via the following algebraic relationship:</p>
<p><span class="math display">
\begin{aligned}[t]
\text{Shape 1:} &amp;&amp; a &amp;= \mu \phi \\
\text{Shape 2:} &amp;&amp; b &amp;= (1 - \mu) \phi
\end{aligned}
\qquad\qquad\qquad
\begin{aligned}[t]
\text{Mean:} &amp;&amp; \mu &amp;= \frac{a}{a + b} \\
\text{Precision:} &amp;&amp; \phi &amp;= a + b
\end{aligned}
</span></p>
<p>The variance can then be calculated as a function of <span class="math inline">\mu</span> and <span class="math inline">\phi</span>:</p>
<p><span class="math display">
\frac{\mu \cdot (1 - \mu)}{1 + \phi}
</span></p>
<p>Importantly, <em>the variance depends on the average value of the response</em>, which is what allows the model to non-linearly adjust to the bounds of the outcome.</p>
</section>
<section id="beta-regression" class="level3">
<h3 data-anchor-id="beta-regression">Beta Regression</h3>
<p>We can use this parameterization of the beta distribution as a regression model of <span class="math inline">\mu</span> (mean) and <span class="math inline">\phi</span> (dispersion) parameters for a random variable that is continuous and bounded. While the beta distribution is presented for a variable that is between 0 and 1, it is straightforward to re-scale any random variable to 0 and 1 using the formula for normalization. Beta regression utilizes a logit link function to model the mean of the response variable as a function of the predictor variables (<span class="math inline">\mu</span>). Another link function, commonly the log (exponential) link, is used to model the dispersion parameter (<span class="math inline">\phi</span>). The application of these links ensures the parameters stay within their respective bounds, with <span class="math inline">\mu</span> between 0 and 1 and <span class="math inline">\phi</span> strictly positive. Overall, the beta regression approach respects the bounded nature of the data and allows for heteroskedasticity, making it highly appropriate for data that represents proportions or rates.</p>
</section>
</section>
</section>
<section id="motivating-example" class="level1">
<h1>Motivating Example</h1>
<section id="data-and-methods" class="level2">
<h2 data-anchor-id="data-and-methods">Data and Methods</h2>
<p>Now that we have built up an intuition about the Beta distribution we can start to analyze some data. The principles of Beta regression are best understood in the context of a real data set. The example we are gonna use comes from the learning and memory literature. A whole host of literature has shown extrinsic cues like fluency (i.e., how easy something is to process) can influence metamemory (i.e., how well we think we will remember something). As an interesting example, a line of research has focused on instructor fluency and how that influences both metamemory and actual learning. When an instructor uses lots of non-verbal gestures, has variable voice dynamics/intonation, is mobile about the space, and includes appropriate pauses when delivering content, participants perceive them as more fluent, but it does not influence actual memory performance, or what we learn from them <span class="citation" data-cites="carpenter2013 toftness2017 witherby2022">(<a href="#ref-carpenter2013" role="doc-biblioref">Carpenter et al., 2013</a>; <a href="#ref-toftness2017" role="doc-biblioref">Toftness et al., 2017</a>; <a href="#ref-witherby2022" role="doc-biblioref">Witherby &amp; Carpenter, 2022</a>)</span>. While fluency of instructor has not been found to impact actual memory across several studies, <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> found that it can. In several experiments, <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> showed that when participants watched two videos of a fluent vs.&nbsp;a disfluent instructor, they remembered more information on a final test. Given the interesting, and contradictory results, we chose this paper to highlight. In the current tutorial we are going to re-analyze the final recall data from Wilford et al(2021; Experiment 1A). In the spirit of open science, the authors made their data available here: <a href="https://osf.io/6tyn4/" class="uri">https://osf.io/6tyn4/</a>.</p>
<p>Accuracy data is widely used in psychology and is well suited for Beta regression. Despite this, it is common to treat accuracy data as continuous and unbounded, and analyze the resulting proportions using methods that fall under the general linear model. Below we will reproduce the analysis conducted by <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> (Experiment 1A) and then re-analyze it using Beta regression. We hope to show how Beta regression and its extensions can be a more powerful tool in making inferences about your data.</p>
<p>In <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> (Experiment 1A), they presented participants with two short videos highlighting two different concepts: (1) genetics of calico cats and (2) an explanation as to why skin wrinkles. Participants viewed either disfluent or fluent versions of these videos.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For each video, metamemory was assessed using JOLs. JOLs require participants to rate an item on scale between 0-100 with 0 representing the item will not be remembered and a 100 representing they will definitely remember the item. In addition, other questions about the instructor were assessed and how much they learned. After a distractor task, a final free recall test was given were participants had to recall as much information about the video as they could in 3 minutes. Participants could score up to 10 points for each video. They looked at the proportion of information recalled (out of 10) as their DV. As a side note, we will only being looking at the final recall data, but you could also analyze the JOL data with a Beta regression.</p>
</section>
<section id="reanalysis-of-wilford-et-al.-experiment-1a" class="level2">
<h2 data-anchor-id="reanalysis-of-wilford-et-al.-experiment-1a">Reanalysis of Wilford et al.&nbsp;Experiment 1A</h2>
<section id="glm-approach" class="level3">
<h3 data-anchor-id="glm-approach">GLM Approach</h3>
<p>In Experiment 1A, <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> only used the first time point (one video) and compared fluent and disfluent conditions with a <em>t</em>-test. They found better performance for participants watching the fluency instructor than the disfluency instructor (see <a href="#fig-flu1" class="quarto-xref" aria-expanded="false">Figure&nbsp;5</a>). In our re-analysis, we will also run a <em>t</em>-test, but in a regression context. This allows for easier generalization to the Beta regression approach that follows. Specifically, we will examine accuracy on final test as our DV (because the score was on a 10 point scale we divided by 10 to get a proportion) and look at Fluency (Fluent vs.&nbsp;Disfluent). Fluency was dummy coded with the fluent level serving as the reference level (coded as 0).</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="1" data-custom-style="FigureWithoutNote">
<div id="tbl-dataset" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="1">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;1</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Dataset</p>
</div>
</figcaption>
<div aria-describedby="tbl-dataset-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_k3xw7m51sujlothw94fe(i, j, css_id) {
          var table = document.getElementById("tinytable_k3xw7m51sujlothw94fe");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_k3xw7m51sujlothw94fe');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_k3xw7m51sujlothw94fe(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_k3xw7m51sujlothw94fe");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 6, j: 0 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_n6g1y7pz7pnzkdr2gbo4',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_mw4xaekf7zgtjeqi4k95',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_k3xw7m51sujlothw94fe(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_n6g1y7pz7pnzkdr2gbo4, .table th.tinytable_css_n6g1y7pz7pnzkdr2gbo4 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_mw4xaekf7zgtjeqi4k95, .table th.tinytable_css_mw4xaekf7zgtjeqi4k95 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_k3xw7m51sujlothw94fe" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Participant</th>
                <th scope="col">Fluency</th>
                <th scope="col">Fluency_dummy</th>
                <th scope="col">Accuracy</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>R_00Owxl28JtOADxn</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.45</td>
                </tr>
                <tr>
                  <td>R_1DZHq7wW6PhBu7l</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.30</td>
                </tr>
                <tr>
                  <td>R_1FfS9t7o3G2waGp</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.40</td>
                </tr>
                <tr>
                  <td>R_1gqH4bLsvaqpRRZ</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.15</td>
                </tr>
                <tr>
                  <td>R_1i4M7ZdpTcywgbq</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.50</td>
                </tr>
                <tr>
                  <td>R_1NyRhBnAB5J2S3r</td>
                  <td>Fluent</td>
                  <td>0</td>
                  <td>0.70</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-flu1" class="quarto-float quarto-figure quarto-figure-center" data-fignum="5" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-flu1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;5</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Raincloud plot for proprotion recalled on final test as a function of fluency</p>
</div>
</figcaption>
<div aria-describedby="fig-flu1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-flu1-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<section id="load-packages-and-data" class="level4">
<h4 data-anchor-id="load-packages-and-data">Load Packages and Data.</h4>
<p>As a first step, we will load the necessary packages along with the data we will be using.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"easystats"</span>, <span class="st">"scales"</span>, <span class="st">"tinytable"</span>, <span class="st">"marginaleffects"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"extraDistr"</span>, <span class="st">"brms"</span>, <span class="st">"posterior"</span>, <span class="st">"bayesplot"</span>, <span class="st">"ggdist"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">walk</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we read in the data from the repo, but you can also read it the directly from this url: <a href="https://raw.githubusercontent.com/jgeller112/beta_regression_tutorial/refs/heads/main/data/miko_data.csv?token=GHSAT0AAAAAAC4SIEVH762DOKQSI2F52YXYZ4AIT3Q" class="uri">https://raw.githubusercontent.com/jgeller112/beta_regression_tutorial/refs/heads/main/data/miko_data.csv?token=GHSAT0AAAAAAC4SIEVH762DOKQSI2F52YXYZ4AIT3Q</a>. Before we begin, we have to make some modifications to the original dataset. Namely, we rename the columns to make them more informative, and transform the data. Here we transform accuracy so it is a proportion by dividng each score by 10. Finally, we dummy code the <code>Fluency</code> variable (<code>Fluency_dummy</code>) setting the fluent condition to 0 and the disfluent condition to 1. The first few rows of the data are displayed in <a href="#tbl-dataset" class="quarto-xref" aria-expanded="false">Table&nbsp;1</a> along with the data dictionary in <a href="#tbl-columnkey" class="quarto-xref" aria-expanded="false">Table&nbsp;2</a>.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="2" data-custom-style="FigureWithoutNote">
<div id="tbl-columnkey" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="2">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-columnkey-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;2</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Data dictionary</p>
</div>
</figcaption>
<div aria-describedby="tbl-columnkey-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_r6h94q1drpudj4elgwq9(i, j, css_id) {
          var table = document.getElementById("tinytable_r6h94q1drpudj4elgwq9");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_r6h94q1drpudj4elgwq9');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_r6h94q1drpudj4elgwq9(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_r6h94q1drpudj4elgwq9");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 4, j: 0 }, { i: 4, j: 1 },  ], css_id: 'tinytable_css_ykx32tt7zhufotjkhjqt',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_l73vbcrivw8ckm2gxun3',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_r6h94q1drpudj4elgwq9(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_ykx32tt7zhufotjkhjqt, .table th.tinytable_css_ykx32tt7zhufotjkhjqt { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_l73vbcrivw8ckm2gxun3, .table th.tinytable_css_l73vbcrivw8ckm2gxun3 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_r6h94q1drpudj4elgwq9" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Column</th>
                <th scope="col">Key</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Participant</td>
                  <td>Participant ID number</td>
                </tr>
                <tr>
                  <td>Fluency</td>
                  <td>Fluent vs. Disfluent</td>
                </tr>
                <tr>
                  <td>FluencyDummy</td>
                  <td>Fluent: 0; Disfluent: 1</td>
                </tr>
                <tr>
                  <td>Accuracy</td>
                  <td>Proportion recalled (idea units)</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit ols reg</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ols_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Accuracy <span class="sc">~</span> Fluency_dummy, <span class="at">data =</span> fluency_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="3" data-tbl-cap-location="top" data-custom-style="FigureWithoutNote">
<div id="tbl-ols" class="cell quarto-float quarto-figure quarto-figure-center" data-after-caption-space="0pt" prefix="" data-tbl-cap-location="top" data-tblnum="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;3</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>OLS regression model coefficents</p>
</div>
</figcaption>
<div aria-describedby="tbl-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_uc4h69jemavjq1alolnu(i, j, css_id) {
          var table = document.getElementById("tinytable_uc4h69jemavjq1alolnu");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_uc4h69jemavjq1alolnu');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_uc4h69jemavjq1alolnu(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_uc4h69jemavjq1alolnu");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 }, { i: 2, j: 4 },  ], css_id: 'tinytable_css_ehh4vkxl3u4okh7vweuy',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_6nqkl0jrzecju740b3kv',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_uc4h69jemavjq1alolnu(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_ehh4vkxl3u4okh7vweuy, .table th.tinytable_css_ehh4vkxl3u4okh7vweuy { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6nqkl0jrzecju740b3kv, .table th.tinytable_css_6nqkl0jrzecju740b3kv { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_uc4h69jemavjq1alolnu" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Coefficient</th>
                <th scope="col">SE</th>
                <th scope="col">95% CI</th>
                <th scope="col">p</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.341</td>
                  <td>0.031</td>
                  <td>[0.279, 0.402]</td>
                  <td>&lt;0.001</td>
                </tr>
                <tr>
                  <td>Fluency_dummy1</td>
                  <td>-0.084</td>
                  <td>0.042</td>
                  <td>[-0.168, -0.001]</td>
                  <td>0.048</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p><a href="#tbl-ols" class="quarto-xref" aria-expanded="false">Table&nbsp;3</a> displays the summary of the OLS regression model. The table shows two coefficients. The <code>Intercept</code> value refers to the accuracy in the fluent condition (because we dummy coded our variable). The <code>Fluency</code> coefficient (<code>Fluency_dummy1</code>) highlights the difference between the fluent and disfluent condition, which is statistically significant, b = -0.084 , SE = 0.042 , 95% CIs = [-0.168,-0.001], p = 0.048. The results reproduce the findings from <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> —better memory when watching the fluent instructor video.</p>
</div>
</section>
</section>
<section id="bayesian-regression" class="level3">
<h3 data-anchor-id="bayesian-regression">Bayesian Regression</h3>
<p>To fit our Bayesian models, we will be using a Bayesian package called <code>brms</code> <span class="citation" data-cites="brms">(<a href="#ref-brms" role="doc-biblioref">Bürkner, 2017</a>)</span> . <code>brms</code> is a powerful and flexible Bayesian regression modeling package that offers built in support for the beta distribution and some of the alternatives we discuss in this tutorial. This reduces the number of different packages researchers have to load in to their environment and makes it easier to build more complex models with similar syntax.</p>
<p>Adopting a Bayesian framework often provides more flexibility and allows us to quantity uncertainty around our estimates which makes it more powerful than the frequentist/MLE alternative. For the purposes of this tutorial, we will not be getting into the minutiae of Bayesian data analysis (i.e., setting informative priors, MCMC sampling, etc,). For a more in-depth look into Bayesian data analysis I refer the reader to <span class="citation" data-cites="mcelreath2020statistical">McElreath (<a href="#ref-mcelreath2020statistical" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="bayes_rules">Johnson et al. (<a href="#ref-bayes_rules" role="doc-biblioref">n.d.</a>)</span>.</p>
<p>For the following analyses we will be using default priors provided by <code>brms</code>, which are non-informative or weak. This will get us something tantamount to a frequentist model with maximum likelihood estimates most of the readers should be familiar with.</p>
<p>We first start out by recreating the regression model from above in <code>brms</code> by using the <code>brm()</code> function and fitting a model looking at final test accuracy (<code>Accuracy</code>) as a function of instructor fluency (<code>fluency_dummy</code>). The syntax is similar to the <code>lm</code> function used above. Here we are concerned at modeling mean performance differences between the fluency and disfluency conditions.</p>
<p>We first start by loading the <code>brms</code> <span class="citation" data-cites="brms">(<a href="#ref-brms" role="doc-biblioref">Bürkner, 2017</a>)</span> and <code>cmdstanr</code> <span class="citation" data-cites="cmdstanr">(<a href="#ref-cmdstanr" role="doc-biblioref">Gabry et al., 2024</a>)</span> packages. We use the <code>cmdstanr</code> backend for Stan <span class="citation" data-cites="stan2023">(<a href="#ref-stan2023" role="doc-biblioref">Team, 2023</a>)</span> because it’s faster and more modern than the defaults used to run models. In order to use the <code>cmdstanr</code> backend you will need to first install the package and also run <code>cmdstanr::install_cmdstan()</code> if you have not done so already.</p>
<p>Then we fit the model using the <code>brm()</code> function. The below model is run with four chains of 2000 Markov chain Monte Carlo iterations. For each chain, there was a 2000-iteration warm-up. The output of these models provides estimates of each effect (the coefficient <code>b_</code>, which is the mean of the posterior distribution), it’s estimation error (the standard deviation of the posterior distribution), and its 95% credible interval (Crl). We inferred that there was evidence of an effect when the 95% Crl estimates did not include zero. Additional arguments were set to speed up the fitting of the models (<code>cores</code> = 4 and <code>backend</code> = <code>cmdstanr</code>) which we will not explain herein.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit ols reg</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>bayes_ols_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(Accuracy <span class="sc">~</span> Fluency_dummy, <span class="at">data =</span> fluency_data, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a> <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"model_ols_bayes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="4" data-tbl-cap-location="top" data-custom-style="FigureWithoutNote">
<div id="tbl-brms-ols" class="cell quarto-float quarto-figure quarto-figure-center" data-after-caption-space="0pt" prefix="" data-tbl-cap-location="top" data-tblnum="4">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-brms-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;4</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Bayesian regression model coefficents</p>
</div>
</figcaption>
<div aria-describedby="tbl-brms-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_y87maksw0zvfexdt1mlm(i, j, css_id) {
          var table = document.getElementById("tinytable_y87maksw0zvfexdt1mlm");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_y87maksw0zvfexdt1mlm');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_y87maksw0zvfexdt1mlm(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_y87maksw0zvfexdt1mlm");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_lqb3r8wau563zvi2mfs4',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_64tg2gd4fsrkt2rimlss',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_y87maksw0zvfexdt1mlm(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_lqb3r8wau563zvi2mfs4, .table th.tinytable_css_lqb3r8wau563zvi2mfs4 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_64tg2gd4fsrkt2rimlss, .table th.tinytable_css_64tg2gd4fsrkt2rimlss { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_y87maksw0zvfexdt1mlm" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>0.341</td>
                  <td>[0.279, 0.405]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.084</td>
                  <td>[-0.17, 0.003]</td>
                  <td>0.97</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p><a href="#tbl-brms-ols" class="quarto-xref" aria-expanded="false">Table&nbsp;4</a> displays the summary of the Bayesian regression model. To make the output more readable, each model parameter is labeled with a prefix before the variable name. Comparing results with the OLS model we ran above our results are very similar. Additionally, the parameters can be interpreted in a similar manner. There are some notable differences, such as the absence of <em>t</em>- and <em>p</em>-values. There is a metric in the table that is included with models fit when using the <code>bayestestr</code> function from <code>easystats</code> called probability of direction (pd) that gives an indication of how much of the posterior distribution estimate is in one direction (positive or negative). The pd measure appears to correlated with <em>p</em>-values (see <span class="citation" data-cites="makowski2019 makowski2019a">(<a href="#ref-makowski2019" role="doc-biblioref">Makowski, Ben-Shachar, &amp; Lüdecke, 2019</a>; <a href="#ref-makowski2019a" role="doc-biblioref">Makowski, Ben-Shachar, Chen, et al., 2019</a>)</span>). A pd of 95%, 97.5%, 99.5% and 99.95% correspond approximately to two-sided p-value of respectively .1, .05, .01 and .001. In addition to the pd value, one can look at the 95% credible interval (sometimes called highest probability density, depending omn the package being used) to see if it includes 0–if it does not then the effect can be said to be significant. In the table below, the 95% credible intervals are located in the <code>CI_low</code> and <code>CI_high</code> columns.</p>
</div>
<p>The <code>b_Intercept</code> value refers to the accuracy in the fluent condition (because we dummy coded our variable). The Fluency coefficient (<code>b_Fluency_dummy1</code>) highlights the difference between the fluent and disfluent conditions, b = -0.084, 95% CrIs = [-0.17,0.003], pd =1. These results map onto the results from the regression analysis above.</p>
</section>
<section id="beta-regression-1" class="level3">
<h3 data-anchor-id="beta-regression-1">Beta Regression</h3>
<p><span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span>, using a traditional OLS approach, observed that instructor fluency impacts actual learning (<em>p</em> = 0.048). Keep in mind the traditional approach assumes normality of residuals and homoscadacity or constant variance. These assumptions are tricky to maintain when the continuous response approaches either the upper or lower boundary of the scale and are almost never true (see <span class="citation" data-cites="sladekova2024unicorns">(<a href="#ref-sladekova2024unicorns" role="doc-biblioref">Sladekova &amp; Field, 2024</a>)</span>. Does the model <code>ols_model_new</code> meet those assumptions? Using <code>easystats</code> <span class="citation" data-cites="easystats">(<a href="#ref-easystats" role="doc-biblioref">Lüdecke et al., 2022</a>)</span> and the <code>check_model()</code> function, we can easily check this. In <a href="#fig-ols-assump" class="quarto-xref" aria-expanded="false">Figure&nbsp;6</a> , we see there definitely some issues with our model. Specifically, there appears to be violations of normality (right figure) and constant variance (homogeneity) (left-hand figure).</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-ols-assump" class="quarto-float quarto-figure quarto-figure-center" data-fignum="6" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-ols-assump-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;6</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Two assumption checks for our OLS model: Normality (left) and Homogeneity (right)</p>
</div>
</figcaption>
<div aria-describedby="fig-ols-assump-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-ols-assump-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>Given the outcome variable is proportional, one solution would be to run a beta regression model.</p>
</div>
<p>We can create the beta regression model in <code>brms</code>. In <code>brms</code>, we model each parameter independently. Recall from the introduction that in a Beta model we fit two parameters—<span class="math inline">\mu</span> and <span class="math inline">\phi</span>. We can easily do this by using the <code>bf()</code> function from <code>brms</code>. <code>bf()</code> facilitates the specification of several sub-models within the same formula call. We fit two formulas, one for <span class="math inline">\mu</span> and one for <span class="math inline">\phi</span> and store it in the <code>model_beta_bayes</code> object below. In the below <code>bf()</code> call, we are modeling Fluency as a function of Accuracy only for the <span class="math inline">\mu</span> parameter. For the <span class="math inline">\phi</span> parameter, we are only modeling the intercept value. This is saying dispersion does not change as a function of fluency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model with mu and phi</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model_beta_bayes <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  Accuracy <span class="sc">~</span> Fluency_dummy, <span class="co"># fit mu model</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  phi <span class="sc">~</span> <span class="dv">1</span> <span class="co"># fit phi model</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we try to run <code>beta_brms</code> we get an error: <code>Error: Family 'beta' requires response greater than 0</code>. This is by design. If your remember, the Beta distribution can only model responses in the interval [0-1], but not responses that are exactly 0 or 1. We need make sure there are no zeros and ones in our dataset.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="5" data-custom-style="FigureWithoutNote">
<div id="tbl-01s" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="5">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-01s-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;5</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Number of zeros and ones in our dataset</p>
</div>
</figcaption>
<div aria-describedby="tbl-01s-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_zg5j3i0gfvxx2m1fsiyj(i, j, css_id) {
          var table = document.getElementById("tinytable_zg5j3i0gfvxx2m1fsiyj");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_zg5j3i0gfvxx2m1fsiyj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_zg5j3i0gfvxx2m1fsiyj(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_zg5j3i0gfvxx2m1fsiyj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 },  ], css_id: 'tinytable_css_v4xz39h1k0nvrx4cxak7',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_vu0cbd5ddwrx3xn8xs07',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_zg5j3i0gfvxx2m1fsiyj(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_v4xz39h1k0nvrx4cxak7, .table th.tinytable_css_v4xz39h1k0nvrx4cxak7 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_vu0cbd5ddwrx3xn8xs07, .table th.tinytable_css_vu0cbd5ddwrx3xn8xs07 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_zg5j3i0gfvxx2m1fsiyj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Accuracy</th>
                <th scope="col">Count</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>0</td>
                  <td>9</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>Looking at our dataset (@tbl-01s) shows we have 9 rows with accuracy of 0, and 1 row with an accuracy of exactly 1. To run a Beta regression, a common hack is to nudge our 0s towards .01 and our 1s to .99 so they fall within the interval of [0-1]. In the below code, the object <code>data_beta</code> has the transformed accuracy values that we will use to re-run our Beta regression.</p>
</div>
<p>We can rerun our model replacing <code>fluency_data</code> with <code>data_beta</code> in the below function call.</p>
<p>No errors this time! We will perform the Beta regression using the nudged values of .01 and .99 values and report our results.</p>
</section>
<section id="model-parameters" class="level3">
<h3 data-anchor-id="model-parameters">Model Parameters</h3>
<p><a href="#tbl-beta-brms" class="quarto-xref" aria-expanded="false">Table&nbsp;6</a> displays the summary from our Bayesian implementation. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The <span class="math inline">\mu</span> parameter estimates, which are labeled with an underscore <code>b_</code>while <span class="math inline">\phi</span> parameter coefficients are tagged with b<code>_phi</code> in the Parameter column.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="6" data-custom-style="FigureWithoutNote">
<div id="tbl-beta-brms" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="6">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;6</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Posterior summary for beta regression using <code>brms</code></p>
</div>
</figcaption>
<div aria-describedby="tbl-beta-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_7yb0jcliam7j9gygkcs7(i, j, css_id) {
          var table = document.getElementById("tinytable_7yb0jcliam7j9gygkcs7");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7yb0jcliam7j9gygkcs7');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_7yb0jcliam7j9gygkcs7(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7yb0jcliam7j9gygkcs7");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 3, j: 0 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 3 },  ], css_id: 'tinytable_css_0ufpk1gj4fp555gwlj99',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_quv50d1fyc4zjj1mf7wy',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_7yb0jcliam7j9gygkcs7(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0ufpk1gj4fp555gwlj99, .table th.tinytable_css_0ufpk1gj4fp555gwlj99 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_quv50d1fyc4zjj1mf7wy, .table th.tinytable_css_quv50d1fyc4zjj1mf7wy { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_7yb0jcliam7j9gygkcs7" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.592</td>
                  <td>[-0.881, -0.313]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>1.211</td>
                  <td>[0.938, 1.463]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.444</td>
                  <td>[-0.831, -0.054]</td>
                  <td>0.988</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="mean-mu-parameter" class="level3">
<h3 data-anchor-id="mean-mu-parameter">Mean <span class="math inline">\mu</span> parameter</h3>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="7" data-custom-style="FigureWithoutNote">
<div id="tbl-beta-mu" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="7">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-mu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;7</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p><span class="math inline">\mu</span> parameter posterior summary</p>
</div>
</figcaption>
<div aria-describedby="tbl-beta-mu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_96dw85et8060o6cjbva0(i, j, css_id) {
          var table = document.getElementById("tinytable_96dw85et8060o6cjbva0");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_96dw85et8060o6cjbva0');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_96dw85et8060o6cjbva0(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_96dw85et8060o6cjbva0");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_6a290bo23bshil0qp2kn',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_01d4vinoc7o35b62kffc',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_96dw85et8060o6cjbva0(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_6a290bo23bshil0qp2kn, .table th.tinytable_css_6a290bo23bshil0qp2kn { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_01d4vinoc7o35b62kffc, .table th.tinytable_css_01d4vinoc7o35b62kffc { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_96dw85et8060o6cjbva0" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.592</td>
                  <td>[-0.881, -0.313]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.444</td>
                  <td>[-0.831, -0.054]</td>
                  <td>0.988</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>In <a href="#tbl-beta-mu" class="quarto-xref" aria-expanded="false">Table&nbsp;7</a> the first set of coefficients (first two rows in the table) represent how factors influence the <span class="math inline">\mu</span> parameter, which is the mean of the beta distribution. These coefficients are interpreted on the scale of the logit, meaning they represent linear changes on a nonlinear space. The intercept term <code>(b_Intercept)</code> represents the log odds of the mean on accuracy for the fluent instructor condition. Log odds that are negative indicate that it is more likely a “success” (like getting the correct answer) will NOT happen than that it will happen. Similarly, regression coefficients in log odds forms that are negative indicate that an increase in that predictor leads to a decrease in the predicted probability of a “success”.</p>
</div>
<section id="predicted-probabilities" class="level4">
<h4 data-anchor-id="predicted-probabilities">Predicted Probabilities.</h4>
<p>Parameter estimates are usually difficult to intercept on their own. We argue that readers should not spend too much time interpreting single model estimates. Instead they should discuss the effects of the predictor on the actual outcome of interest (in this case the 0-1 scale). The logit link allows us to transform back and forth between the scale of a linear model and the nonlinear scale of the outcome, which is bounded by 0 and 1. By using the inverse of the logit, we can easily transform our linear coefficients to obtain average effects on the scale of the proportions or percentages, which is usually what is interesting to applied researchers. In a simple case, we can do this manually, but when there are many factors in your model this can be quite complex.</p>
<p>To help us extract predictions from our model we will use a package called <strong><code>marginaleffects</code></strong> <span class="citation" data-cites="margeffects2024">(<a href="#ref-margeffects2024" role="doc-biblioref">Arel-Bundock et al., 2024</a>)</span>. <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> To get the proportions for each of our categorical predictors on the mu parameter we can use the function from the package called <code>predictions()</code>. These are displayed in <a href="#tbl-predict-prob" class="quarto-xref" aria-expanded="false">Table&nbsp;8</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load marginaleffects package</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use predictions to get predicted probs for each condition</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predictions</span>(beta_brms,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">Fluency_dummy =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="8" data-tbl-cap-location="top" data-custom-style="FigureWithoutNote">
<div id="tbl-predict-prob" class="cell quarto-float quarto-figure quarto-figure-center" data-after-caption-space="0pt" prefix="" data-tbl-cap-location="top" data-tblnum="8">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-predict-prob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;8</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Predicted probablities for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="tbl-predict-prob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_dipqx22zhwea4nkoj8is(i, j, css_id) {
          var table = document.getElementById("tinytable_dipqx22zhwea4nkoj8is");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_dipqx22zhwea4nkoj8is');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_dipqx22zhwea4nkoj8is(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_dipqx22zhwea4nkoj8is");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 },  ], css_id: 'tinytable_css_t4a2k3962tvlz3cmk2y0',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_2ch47hmydg5w6jplvkqk',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_dipqx22zhwea4nkoj8is(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_t4a2k3962tvlz3cmk2y0, .table th.tinytable_css_t4a2k3962tvlz3cmk2y0 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_2ch47hmydg5w6jplvkqk, .table th.tinytable_css_2ch47hmydg5w6jplvkqk { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_dipqx22zhwea4nkoj8is" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Fluency_dummy</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluent</td>
                  <td>0.357</td>
                  <td>[0.293, 0.422]</td>
                </tr>
                <tr>
                  <td>Disfluent</td>
                  <td>0.263</td>
                  <td>[0.213, 0.319]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>For the <code>Fluency</code> factor, we can interpret the <code>Mean</code> column in terms of proportions or percentages. That is, participants who watched the fluent instructor scored on average 36% on the final exam compared to 26% for those who watched the disfluent instructor.</p>
</div>
<p>We can also easily visualize these from <code>marginaleffects</code> using the <code>plot_predictions</code> function. After using this function, the proportions are visualized in <a href="#fig-plot-pre" class="quarto-xref" aria-expanded="false">Figure&nbsp;7</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>beta_plot <span class="ot">&lt;-</span> <span class="fu">plot_predictions</span>(beta_brms, <span class="at">condition =</span> <span class="st">"Fluency_dummy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-plot-pre" class="quarto-float quarto-figure quarto-figure-center" data-fignum="7" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-pre-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;7</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Predicted probablities for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="fig-plot-pre-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-plot-pre-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
<section id="marginal-effects" class="level5">
<h5 data-anchor-id="marginal-effects">Marginal Effects.</h5>
<p>Marginal effects provide a way to understand how changes in a predictor influence an outcome, holding all other factors constant in a specific manner. Technically, marginal effects are calculated using partial derivatives for continuous variables or finite differences for categorical and continuous variables, depending on the nature of the data and the research question. Substantively, these effects translate regression coefficients into a form that can be interpreted directly on the outcome scale of interest.</p>
<p>There are various types of marginal effects, and their calculation can vary across software packages. For example, the popular <code>emmeans</code> package [] computes marginal effects by holding all predictors at their means. In this tutorial, we will use the <code>marginaleffects</code> package, which focuses on average marginal effects (AMEs) by default. AMEs summarize effects by generating predictions for each row of the original dataset and then averaging these predictions. This approach retains a strong connection to the original data while offering a straightforward summary of the effect of interest.</p>
<p>One practical application of AMEs is calculating the risk difference for categorical variables. The risk difference represents the difference in average outcomes between two groups or conditions. Using the <code>avg_comparisons()</code> function in the <code>marginaleffects</code> package, we can compute this metric directly. By default, the function calculates the discrete difference between groups. It can also compute other effect size metrics, such as odds ratios and risk ratios, depending on the research question (see <a href="#tbl-or" class="quarto-xref" aria-expanded="false">Table&nbsp;10</a> for more details). This flexibility makes it a powerful tool for interpreting regression results in a meaningful way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get risk difference by default</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>beta_avg_comp <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(beta_brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="9" data-custom-style="FigureWithoutNote">
<div id="tbl-ame1" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="9">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ame1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;9</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Risk difference for fluency</p>
</div>
</figcaption>
<div aria-describedby="tbl-ame1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_d3yn3crb8zvjvdmtumr5(i, j, css_id) {
          var table = document.getElementById("tinytable_d3yn3crb8zvjvdmtumr5");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_d3yn3crb8zvjvdmtumr5');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_d3yn3crb8zvjvdmtumr5(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_d3yn3crb8zvjvdmtumr5");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_uvfgmfmc6gdlkjod0u0r',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_26vna8jsyuu9s64i2q22',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_d3yn3crb8zvjvdmtumr5(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_uvfgmfmc6gdlkjod0u0r, .table th.tinytable_css_uvfgmfmc6gdlkjod0u0r { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_26vna8jsyuu9s64i2q22, .table th.tinytable_css_26vna8jsyuu9s64i2q22 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_d3yn3crb8zvjvdmtumr5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Term</th>
                <th scope="col">Contrast</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluency_dummy</td>
                  <td>1 - 0</td>
                  <td>-0.094</td>
                  <td>[-0.176, -0.012]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p><a href="#tbl-ame1" class="quarto-xref" aria-expanded="false">Table&nbsp;9</a> displays the risk difference for the fluency factor (<code>estimate</code> column). The difference between the fluent and disfluent conditions is .09. That is, participants who watched a fluent instructor scored 9% higher on the final recall test than participants who watched the disfluent instructor. Our credible interval [-.0174, -0.011] does not include zero so we can say it is statistically significant.</p>
</div>
<p>We can also get the odds ratio with <code>avg_comparisons</code> (see <a href="#tbl-or" class="quarto-xref" aria-expanded="false">Table&nbsp;10</a>).</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="10" data-custom-style="FigureWithoutNote">
<div id="tbl-or" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="10">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-or-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;10</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Odds ratio for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="tbl-or-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_anbgnozkkuxb4qjl0wvu(i, j, css_id) {
          var table = document.getElementById("tinytable_anbgnozkkuxb4qjl0wvu");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_anbgnozkkuxb4qjl0wvu');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_anbgnozkkuxb4qjl0wvu(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_anbgnozkkuxb4qjl0wvu");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_xi1qz5s1gx352tr4zqw1',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_a5g1275hdox70wwruz7r',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_anbgnozkkuxb4qjl0wvu(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_xi1qz5s1gx352tr4zqw1, .table th.tinytable_css_xi1qz5s1gx352tr4zqw1 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_a5g1275hdox70wwruz7r, .table th.tinytable_css_a5g1275hdox70wwruz7r { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_anbgnozkkuxb4qjl0wvu" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Term</th>
                <th scope="col">Contrast</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluency_dummy</td>
                  <td>ln(odds(1) / odds(0))</td>
                  <td>0.642</td>
                  <td>[0.436, 0.947]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>In psychology, it is common to report effect size measures like Cohen’s D. When working with proportions we can calculate something similar called Cohen’s <em>h</em>. Taking our proportions, we can use the below equation to calculate Cohen’s <em>h</em> along with the 95% Cr.Is around it.</p>
</div>
<p><span class="math display">
h = 2 \cdot \left( \arcsin\left(\sqrt{p_1}\right) - \arcsin\left(\sqrt{p_2}\right) \right)
</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.17</code></pre>
</div>
</div>
<p>Using this metric we see the effect size is small (0.17), 95% CrI [-0.002, 0.361].</p>
</section>
</section>
</section>
<section id="precision-phi-component" class="level3">
<h3 data-anchor-id="precision-phi-component">Precision (<span class="math inline">\phi</span>) Component</h3>
<p>The other component we need to pay attention to is the dispersion or precision parameter coefficients labeled as `<code>b_phi</code> in <a href="#tbl-phi-dis" class="quarto-xref" aria-expanded="false">Table&nbsp;11</a>. The dispersion (<span class="math inline">\phi</span>) parameter tells us how precise our estimate is. Specifically, <span class="math inline">\phi</span> in Beta regression tells us about the variability of the response variable around its mean. Specifically, a higher dispersion parameter indicates a narrower distribution, reflecting less variability. Conversely, a lower dispersion parameter suggests a wider distribution, reflecting greater variability. The main difference between a dispersion parameter and the variance is that the dispersion has a different interpretation depending on the value of the outcome, as we show below. The best way to understand dispersion is to examine visual changes in the distribution as the dispersion increases or decreases.</p>
<p>Understanding the dispersion parameter helps us gauge the precision of our predictions and the consistency of the response variable. In <code>beta_brms</code> we only modeled the dispersion of the intercept. When <span class="math inline">\phi</span> is not specified, the intercept is modeled by default (see <a href="#tbl-phi-dis" class="quarto-xref" aria-expanded="false">Table&nbsp;11</a>).</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="11" data-custom-style="FigureWithoutNote">
<div id="tbl-phi-dis" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="11">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-phi-dis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;11</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Dispersion parameter</p>
</div>
</figcaption>
<div aria-describedby="tbl-phi-dis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_wdi5qa89qtycx2oknyfm(i, j, css_id) {
          var table = document.getElementById("tinytable_wdi5qa89qtycx2oknyfm");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_wdi5qa89qtycx2oknyfm');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_wdi5qa89qtycx2oknyfm(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_wdi5qa89qtycx2oknyfm");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_35zv8p2uf3uke39ci487',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_reqj82g4yttpcbmp5bej',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_wdi5qa89qtycx2oknyfm(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_35zv8p2uf3uke39ci487, .table th.tinytable_css_35zv8p2uf3uke39ci487 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_reqj82g4yttpcbmp5bej, .table th.tinytable_css_reqj82g4yttpcbmp5bej { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_wdi5qa89qtycx2oknyfm" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>1.21</td>
                  <td>[0.938, 1.463]</td>
                  <td>1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>The intercept under the precision heading is not that interesting. It represents the overall dispersion in the model. We can model the dispersion of the <code>Fluency</code> factor—this allows dispersion to differ between the fluent and disfluent conditions. To do this we add <code>Fluency_dummy</code> to the phi model in <code>bf()</code>. We model the precision of the <code>Fluency</code> factor by using a <code>~</code> and adding factors of interest to the right of it.</p>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="12" data-custom-style="FigureWithoutNote">
<div id="tbl-beta-mu-dis" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="12">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beta-mu-dis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;12</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p><span class="math inline">\mu</span> and <span class="math inline">\phi</span> posterior summary</p>
</div>
</figcaption>
<div aria-describedby="tbl-beta-mu-dis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_qremix7sxdjyrn36lz7z(i, j, css_id) {
          var table = document.getElementById("tinytable_qremix7sxdjyrn36lz7z");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_qremix7sxdjyrn36lz7z');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_qremix7sxdjyrn36lz7z(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_qremix7sxdjyrn36lz7z");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 4, j: 0 }, { i: 4, j: 1 }, { i: 4, j: 2 }, { i: 4, j: 3 },  ], css_id: 'tinytable_css_07ve3dys2nacnmroq82t',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_cd0jszdv4p3n8onvabol',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_qremix7sxdjyrn36lz7z(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_07ve3dys2nacnmroq82t, .table th.tinytable_css_07ve3dys2nacnmroq82t { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_cd0jszdv4p3n8onvabol, .table th.tinytable_css_cd0jszdv4p3n8onvabol { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_qremix7sxdjyrn36lz7z" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.679</td>
                  <td>[-0.905, -0.443]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>1.806</td>
                  <td>[1.389, 2.177]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.24</td>
                  <td>[-0.64, 0.156]</td>
                  <td>0.887</td>
                </tr>
                <tr>
                  <td>b_phi_Fluency_dummy1</td>
                  <td>-0.927</td>
                  <td>[-1.468, -0.402]</td>
                  <td>1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p><a href="#tbl-beta-mu-dis" class="quarto-xref" aria-expanded="false">Table&nbsp;12</a> displays the model summary with the precision parameter added to our model as a function of fluency. It is important to note that the estimates are logged and not on the original scale (this is only the case when additional parameters are modeled). To interpret them on the original scale, we can exponentiate the log-transformed value—this transformation gets us back to our original scale (see <a href="#tbl-phi-beta-exp" class="quarto-xref" aria-expanded="false">Table&nbsp;13</a>). In below model call, we set <code>exponentiate</code> = TRUE.</p>
</div>
<div class="cell" data-after-caption-space="0pt">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>beta_model_dis_exp <span class="ot">&lt;-</span> beta_brms_dis <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate=</span><span class="cn">TRUE</span>, <span class="at">centrality =</span> <span class="st">"mean"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="13" data-custom-style="FigureWithoutNote">
<div id="tbl-phi-beta-exp" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="13">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-phi-beta-exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;13</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Beta regression model summary for fluency factor with <span class="math inline">\phi</span> parameter exponentiated</p>
</div>
</figcaption>
<div aria-describedby="tbl-phi-beta-exp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_j2cc8ywr5yq3x4vzotdd(i, j, css_id) {
          var table = document.getElementById("tinytable_j2cc8ywr5yq3x4vzotdd");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_j2cc8ywr5yq3x4vzotdd');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_j2cc8ywr5yq3x4vzotdd(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_j2cc8ywr5yq3x4vzotdd");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_lb69c8rlu0ytbr59b95w',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_qp92r4vfkksglpeeko4i',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_j2cc8ywr5yq3x4vzotdd(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_lb69c8rlu0ytbr59b95w, .table th.tinytable_css_lb69c8rlu0ytbr59b95w { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_qp92r4vfkksglpeeko4i, .table th.tinytable_css_qp92r4vfkksglpeeko4i { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_j2cc8ywr5yq3x4vzotdd" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>6.089</td>
                  <td>[4.01, 8.82]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Fluency_dummy1</td>
                  <td>0.396</td>
                  <td>[0.23, 0.669]</td>
                  <td>1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>The <span class="math inline">\phi</span> intercept represents the precision of the fluent condition. The <span class="math inline">\phi</span> coefficient for <code>Fluency_dummy1</code> represents the change in that precision for performance between the fluent vs.&nbsp;disfluent conditions. The Cr.intervals [.235, .684] do not include 0 so our results are statistically significant.</p>
</div>
<p>It is important to note that these estimates are not the same as the marginal effects we discussed earlier. Changes in dispersion will change the shape of the distribution but not necessarily the average value of the response. This makes dispersion most interesting for research questions that focus on other features of the distribution besides the mean, such as the level of polarization in an outcome.</p>
<p>A critical assumption of the GLM is homoscedasticity, which means constant variance of the errors. Here we see one of the benefits of a beta regression model: we can include a dispersion parameter for Fluency. Properly accounting for dispersion is crucial because it impacts the precision of our mean estimates and, consequently, the significance of our coefficients. The inclusion of dispersion in the our model increased the uncertainty of the <span class="math inline">\mu</span> coefficient (see <a href="#fig-plt-diff" class="quarto-xref" aria-expanded="false">Figure&nbsp;8</a>)–our Cr.I is now very close to zero. This suggests that failing to account for the dispersion of the variables might lead to biased estimates. This highlights the potential utility of an approach like beta regression over a traditional approach as Beta regression can explicitly model dispersion and address issues of heteroscedasticity.</p>
<p>We won’t always need to include dispersion parameters for each of our variables. We advise conducting very simple model comparisons like leave one out (loo) cross validation to examine if a dispersion parameter should be considered in our model.</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-plt-diff" class="quarto-float quarto-figure quarto-figure-center" data-fignum="8" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plt-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;8</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Comparison of posterior distributions for the risk difference in fluency: Simple model (no dispersion for Fluency) vs.&nbsp;complex model with dispersion</p>
</div>
</figcaption>
<div aria-describedby="fig-plt-diff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-plt-diff-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="posterior-predictive-check" class="level3">
<h3 data-anchor-id="posterior-predictive-check">Posterior Predictive Check</h3>
<p>It is a always a good idea to check how well your data fits the model. The <code>pp_check()</code> function allows us to examine the fit between our data and the model. In <a href="#fig-post-pred" class="quarto-xref" aria-expanded="false">Figure&nbsp;9</a>, multiple draws or repetitions from the posterior distribution are plotted (light blue lines) against the observed data. (dark blue). Ideally, the predictive draws (the light blue lines) should show reasonable resemblance with the observed data (dark blue line). We see it does a pretty good job capturing the data. Ideally, the predictive draws (the light blue lines) should show reasonable resemblance with the observed data (dark blue line). We see it does a pretty good job capturing the data.</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-post-pred" class="quarto-float quarto-figure quarto-figure-center" data-fignum="9" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-post-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;9</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Posterior predictive check for our Beta model with 100 draws.</p>
</div>
</figcaption>
<div aria-describedby="fig-post-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-post-pred-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="zero-inflated-beta-zib-regression" class="level2">
<h2 data-anchor-id="zero-inflated-beta-zib-regression">Zero-Inflated Beta (ZIB) Regression</h2>
<p>A limitation of the beta regression model is it can can only model values between 0 and 1, but not exactly 0 or 1. In our dataset we have 9 rows with <code>Accuracy</code> equal to zero.</p>
<p>To use the Beta distribution we nudged our zeros to 0.01–which is never a good idea in practice. In our case it might be important to model the structural zeros in our data, as fluency of instructor might be an important factor in predicting the zeros in our model. There is a model called the zero-inflated beta (ZIB) model that takes into account the structural 0s in our data. We’ll still model the <span class="math inline">\mu</span> and <span class="math inline">\phi</span> (or mean and precision) of the beta distribution, but now we’ll also add one new special parameter: <span class="math inline">\alpha</span>.</p>
<p>With zero-inflated regression, we’re actually modelling a mixture of the data-generating process. The <span class="math inline">\alpha</span> parameter uses a logistic regression to model whether the data is 0 or not. Substantively, this could be a useful model when we think that 0s come from a process that is relatively distinct from the data that is greater than 0. For example, if we had a dataset of with proportion of looks or eye fixations to certain areas on marketing materials, we might want a separate model for those that do not look at certain areas on the screen because individuals who do not look might be substantively different than those that look.</p>
<p>We can fit a ZIB model using <code>brms</code> and use the <code>marginaleffects</code> package to make inferences about our parameters of interest. Similar to our Beta regression model we fit in <code>brms</code>, we will use the <code>bf()</code> function to fit several models. We fit our <span class="math inline">\mu</span> and <span class="math inline">\phi</span> parameters as well as our zero-inflated parameter (<span class="math inline">\alpha</span>; here labeled as <code>zi</code>). In <code>brms</code> we can use the zero_inflated_beta family.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keep 0 but transform 1 to .99</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_beta_0 <span class="ot">&lt;-</span> fluency_data <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Accuracy =</span> <span class="fu">ifelse</span>(Accuracy <span class="sc">==</span> <span class="dv">1</span>, .<span class="dv">99</span>, Accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fit zero-inflated beta in brms</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>zib_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  Accuracy <span class="sc">~</span> Fluency_dummy, <span class="co"># The mean of the 0-1 values, or mu</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  phi <span class="sc">~</span> Fluency_dummy, <span class="co"># The precision of the 0-1 values, or phi</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  zi <span class="sc">~</span> Fluency_dummy, <span class="co"># The zero-or-one-inflated part, or alpha</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_beta</span>()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below we pass <code>zib_model</code> to the <code>brm</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit_zi <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> zib_model,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_beta_0,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"model_beta_bayes_zib"</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="14" data-custom-style="FigureWithoutNote">
<div id="tbl-brms-zib" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="14">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-brms-zib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;14</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Model summary (posterior distribution) for zero-inflated beta model</p>
</div>
</figcaption>
<div aria-describedby="tbl-brms-zib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_214eztw22p77lvvy68h7(i, j, css_id) {
          var table = document.getElementById("tinytable_214eztw22p77lvvy68h7");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_214eztw22p77lvvy68h7');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_214eztw22p77lvvy68h7(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_214eztw22p77lvvy68h7");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 6, j: 0 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_4yaagcitdpsugyqzjc95',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_cxdh2ufvfze98r99ruge',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_214eztw22p77lvvy68h7(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_4yaagcitdpsugyqzjc95, .table th.tinytable_css_4yaagcitdpsugyqzjc95 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_cxdh2ufvfze98r99ruge, .table th.tinytable_css_cxdh2ufvfze98r99ruge { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_214eztw22p77lvvy68h7" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.628</td>
                  <td>[-0.842, -0.408]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>2.024</td>
                  <td>[1.596, 2.414]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.034</td>
                  <td>[-0.394, 0.339]</td>
                  <td>0.571</td>
                </tr>
                <tr>
                  <td>b_phi_Fluency_dummy1</td>
                  <td>-0.831</td>
                  <td>[-1.392, -0.272]</td>
                  <td>0.998</td>
                </tr>
                <tr>
                  <td>b_zi_Intercept</td>
                  <td>-3.798</td>
                  <td>[-6.137, -2.234]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_zi_Fluency_dummy1</td>
                  <td>2.108</td>
                  <td>[0.25, 4.588]</td>
                  <td>0.991</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<section id="predicted-probabilities-and-marginal-effects" class="level3">
<h3 data-anchor-id="predicted-probabilities-and-marginal-effects">Predicted Probabilities and Marginal Effects</h3>
<p><a href="#tbl-brms-zib" class="quarto-xref" aria-expanded="false">Table&nbsp;14</a> provides a summary of the posterior distribution for each parameter. As stated before, it is preferable to back-transform our estimates to get probabilities. We can model the parameters separately using the <code>dpar</code> argument setting to: <span class="math inline">\mu</span>, <span class="math inline">\phi</span>, <span class="math inline">\alpha</span>. To get the predicted probabilities we can use the <code>avg_predictions()</code> function and to get risk difference between the levels of each factor we can use the <code>avg_comparisons()</code> function from <code>marginaleffects</code> package. Here we look at the risk difference for Fluency under each parameter.</p>
<section id="mean-mu" class="level4">
<h4 data-anchor-id="mean-mu">Mean (<span class="math inline">\mu</span>).</h4>
<p>Looking at <a href="#tbl-marg-mu-brms" class="quarto-xref" aria-expanded="false">Table&nbsp;15</a> there is no significant effect for Fluency.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="15" data-custom-style="FigureWithoutNote">
<div id="tbl-marg-mu-brms" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marg-mu-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;15</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Risk difference (mu) for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="tbl-marg-mu-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_ol59jihz28cba10yo6o1(i, j, css_id) {
          var table = document.getElementById("tinytable_ol59jihz28cba10yo6o1");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ol59jihz28cba10yo6o1');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_ol59jihz28cba10yo6o1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ol59jihz28cba10yo6o1");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_cr7ziw9fbu6egpn9rsyp',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_je60hcm01kpmhhltwwze',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_ol59jihz28cba10yo6o1(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_cr7ziw9fbu6egpn9rsyp, .table th.tinytable_css_cr7ziw9fbu6egpn9rsyp { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_je60hcm01kpmhhltwwze, .table th.tinytable_css_je60hcm01kpmhhltwwze { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_ol59jihz28cba10yo6o1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Term</th>
                <th scope="col">Contrast</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluency_dummy</td>
                  <td>1 - 0</td>
                  <td>-0.007</td>
                  <td>[-0.087, 0.078]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="dispersion-phi" class="level4">
<h4 data-anchor-id="dispersion-phi">Dispersion (<span class="math inline">\phi</span>).</h4>
<p>Looking at <a href="#tbl-marg-phi-brms" class="quarto-xref" aria-expanded="false">Table&nbsp;16</a>, there is a significant effect of fluency on dispersion, with disfluency having a larger variation than fluency.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="16" data-custom-style="FigureWithoutNote">
<div id="tbl-marg-phi-brms" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="16">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marg-phi-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;16</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Risk difference (Phi) for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="tbl-marg-phi-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_bxr0buicdzamviix5nmj(i, j, css_id) {
          var table = document.getElementById("tinytable_bxr0buicdzamviix5nmj");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bxr0buicdzamviix5nmj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_bxr0buicdzamviix5nmj(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bxr0buicdzamviix5nmj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_idtlpr36mgzh0ch0bli0',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_s9vndekfil0776zqxojk',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_bxr0buicdzamviix5nmj(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_idtlpr36mgzh0ch0bli0, .table th.tinytable_css_idtlpr36mgzh0ch0bli0 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_s9vndekfil0776zqxojk, .table th.tinytable_css_s9vndekfil0776zqxojk { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_bxr0buicdzamviix5nmj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Term</th>
                <th scope="col">Contrast</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluency_dummy</td>
                  <td>1 - 0</td>
                  <td>-4.37</td>
                  <td>[-7.984, -1.274]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="zero-inflated-alpha" class="level3">
<h3 data-anchor-id="zero-inflated-alpha">Zero-Inflated (<span class="math inline">\alpha</span>)</h3>
<p>In <a href="#tbl-marg-zib-brms" class="quarto-xref" aria-expanded="false">Table&nbsp;17</a> we see that watching a lecture video with a fluent instructor reduces the proportion of zeros by about 13%. The CrI does not include zero.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="17" data-custom-style="FigureWithoutNote">
<div id="tbl-marg-zib-brms" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="17">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marg-zib-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;17</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Posterior summary of the risk difference (zero-inflated) for fluency factor</p>
</div>
</figcaption>
<div aria-describedby="tbl-marg-zib-brms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_hb3vrkq2fbxpi73dtvcj(i, j, css_id) {
          var table = document.getElementById("tinytable_hb3vrkq2fbxpi73dtvcj");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_hb3vrkq2fbxpi73dtvcj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_hb3vrkq2fbxpi73dtvcj(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_hb3vrkq2fbxpi73dtvcj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_ln23bl4aoxphe5a41zvu',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_4b310k99hd81wdsorff4',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_hb3vrkq2fbxpi73dtvcj(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_ln23bl4aoxphe5a41zvu, .table th.tinytable_css_ln23bl4aoxphe5a41zvu { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_4b310k99hd81wdsorff4, .table th.tinytable_css_4b310k99hd81wdsorff4 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_hb3vrkq2fbxpi73dtvcj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Term</th>
                <th scope="col">Contrast</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Fluency_dummy</td>
                  <td>1 - 0</td>
                  <td>0.13</td>
                  <td>[0.02, 0.25]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>If we wanted we could easily visualize the zero-inflated part of the model (see <a href="#fig-zi-plot" class="quarto-xref" aria-expanded="false">Figure&nbsp;10</a>).</p>
</div>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-zi-plot" class="quarto-float quarto-figure quarto-figure-center" data-fignum="10" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-zi-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;10</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Visualization of predicted probablites for zero-inflated part of model</p>
</div>
</figcaption>
<div aria-describedby="fig-zi-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-zi-plot-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="zero-one-inflated-beta-zoib" class="level2">
<h2 data-anchor-id="zero-one-inflated-beta-zoib">Zero-One-Inflated Beta (ZOIB)</h2>
<p>The ZIB model works well if you have 0s in your data, but not 1s.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> Sometimes it is theoretically useful to model both zeros and ones as separate processes or to consider these values as essentially similar parts of the continuous response, as we show later in the ordered Beta regression model. For example, this is important in visual analog scale data where there might be a prevalence of responses at the bounds <span class="citation" data-cites="kong2016">(<a href="#ref-kong2016" role="doc-biblioref">Kong &amp; Edwards, 2016</a>)</span>, in JOL tasks <span class="citation" data-cites="wilford2020">(<a href="#ref-wilford2020" role="doc-biblioref">Wilford et al., 2020</a>)</span>, or in a free-list task where individuals provide open responses to some question or topic which are then recoded to fall between 0-1 <span class="citation" data-cites="bendixen2023">(<a href="#ref-bendixen2023" role="doc-biblioref">Bendixen &amp; Purzycki, 2023</a>)</span>. Here 0s and 1s are meaningful; 0 means item was not listed and 1 means the item was listed first.</p>
<p>In our data, we have exactly one value equal to 1. While probably not significant to alter our findings, we can model ones with a special type of model called the zero-one-inflated beta (ZOIB) model if we believe that both 0s and 1s are distinct outcomes.</p>
<p>Similar to our beta and zero-inflated models above, we can fit a ZOIB model in <code>brms</code> quite easily using the <code>zero_one_inflated_beta</code> family. In this model, we fit four parameters or sub-models. We fit separate models for the mean (<span class="math inline">\mu</span>) and the precision (<span class="math inline">\phi</span>) of the Beta distribution; a zero-one inflation parameter (i.e.&nbsp;the probability that an observation is either 0 or 1; <span class="math inline">\alpha</span> ) from the zero-inflated model; and a ‘conditional one inflation’ parameter (i.e.&nbsp;the probability that, given an observation is 0 or 1, the observation is 1; <span class="math inline">\gamma</span>). This specification captures the entire range of possible values while still being constrained between zero and one.</p>
<p>We use the <code>bf()</code> function again to fit models for our four parameters. We model each parameter as a function of Fluency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the zoib model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>zoib_model <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  Accuracy <span class="sc">~</span> Fluency_dummy, <span class="co"># The mean of the 0-1 values, or mu</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  phi <span class="sc">~</span> Fluency_dummy, <span class="co"># The precision of the 0-1 values, or phi</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  zoi <span class="sc">~</span> Fluency_dummy, <span class="co"># The zero-or-one-inflated part, or alpha</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  coi <span class="sc">~</span> Fluency_dummy, <span class="co"># The one-inflated part, conditional on the 0s, or gamma</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then pass the <code>zoib_model</code> to our <code>brm()</code> function. The summary of the output is in <a href="#tbl-zoib" class="quarto-xref" aria-expanded="false">Table&nbsp;18</a> .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run the zoib mode using brm</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fit_zoib <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> zoib_model,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fluency_data,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"model_beta_zoib_1"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="18" data-custom-style="FigureWithoutNote">
<div id="tbl-zoib" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="18">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-zoib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;18</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Model summary (posterior distribution) for the zero-one inflated beta model</p>
</div>
</figcaption>
<div aria-describedby="tbl-zoib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_vb19fjblf66n244m7gg9(i, j, css_id) {
          var table = document.getElementById("tinytable_vb19fjblf66n244m7gg9");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_vb19fjblf66n244m7gg9');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_vb19fjblf66n244m7gg9(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_vb19fjblf66n244m7gg9");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 8, j: 0 }, { i: 8, j: 1 }, { i: 8, j: 2 }, { i: 8, j: 3 },  ], css_id: 'tinytable_css_8lvgeqfjlj44dx86l5bg',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_tj3sphgfb17fmc9l2h8n',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_vb19fjblf66n244m7gg9(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_8lvgeqfjlj44dx86l5bg, .table th.tinytable_css_8lvgeqfjlj44dx86l5bg { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_tj3sphgfb17fmc9l2h8n, .table th.tinytable_css_tj3sphgfb17fmc9l2h8n { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_vb19fjblf66n244m7gg9" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.626</td>
                  <td>[-0.844, -0.408]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>2.024</td>
                  <td>[1.602, 2.424]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_zoi_Intercept</td>
                  <td>-3.822</td>
                  <td>[-6.137, -2.19]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_coi_Intercept</td>
                  <td>-1.951</td>
                  <td>[-8.99, 2.799]</td>
                  <td>0.743</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.198</td>
                  <td>[-0.541, 0.164]</td>
                  <td>0.866</td>
                </tr>
                <tr>
                  <td>b_phi_Fluency_dummy1</td>
                  <td>-0.427</td>
                  <td>[-0.996, 0.149]</td>
                  <td>0.925</td>
                </tr>
                <tr>
                  <td>b_zoi_Fluency_dummy1</td>
                  <td>2.29</td>
                  <td>[0.454, 4.68]</td>
                  <td>0.996</td>
                </tr>
                <tr>
                  <td>b_coi_Fluency_dummy1</td>
                  <td>-0.138</td>
                  <td>[-5.997, 7.3]</td>
                  <td>0.551</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<section id="model-parameters-1" class="level3">
<h3 data-anchor-id="model-parameters-1">Model Parameters</h3>
<p>The output for the model is pretty lengthy (see <a href="#tbl-zoib" class="quarto-xref" aria-expanded="false">Table&nbsp;18</a>)—we are estimating four parameters each with their own independent responses and sub-models. All the coefficients are on the logit scale, except <span class="math inline">\phi</span> , which is on the log scale. Thankfully drawing inferences for all these different parameters, plotting their distributions, and estimating their average marginal effects looks exactly the same—all the <code>brms</code> and <code>marginaleffects</code> functions we used work the same.</p>
</section>
<section id="predictions-and-marginal-effects" class="level3">
<h3 data-anchor-id="predictions-and-marginal-effects">Predictions and Marginal Effects</h3>
<p>With <code>marginaleffects</code> we can choose marginalize over all the sub-models, averaged across the 0s, continuous responses, and 1s in the data, or we can model the parameters separately using the <code>dpar</code> argument like we did above setting it to: <span class="math inline">\mu</span>, <span class="math inline">\phi</span>, <span class="math inline">\alpha</span>, <span class="math inline">\gamma</span>. Using <code>avg_predictions()</code> and not setting <code>dpar</code> we can get the predicted probabilities across all the sub-models. We can also plot the overall difference between fluency and disfluency for the whole model with <code>plot_predictions</code>. Our results are very similar to the zero-inflated model from above.</p>
</section>
</section>
<section id="ordered-beta-regression" class="level2">
<h2 data-anchor-id="ordered-beta-regression">Ordered Beta Regression</h2>
<p>Looking at the output from the ZOIB model <a href="#tbl-zoib" class="quarto-xref" aria-expanded="false">Table&nbsp;18</a>, we can see how running a model like this can become vastly complex and computational intensive as it is fitting sub-models for each parameter. The ability to consider 0s and 1s as distinct processes from continuous values comes at a price in terms of complexity. A special version of the ZOIB was recently developed called ordered beta regression <span class="citation" data-cites="kubinec2022">(<a href="#ref-kubinec2022" role="doc-biblioref">Kubinec, 2022</a>)</span>. The ordered beta regression model allows for the analysis of continuous data (between 0-1) and discrete outcomes (e.g., 0 or 1) without requiring that either be fully distinct from the other. In the simplest sense, the ordered beta regression model is a hybrid model that estimates a weighted combination of a beta regression model for continuous responses and a logit model for the discrete values of the response.</p>
<p>The weights that average together the two parts of the outcome (i.e., discrete and continuous) are determined by cutpoints that are estimated in conjunction with the data in a similar manner to what is known as an ordered logit model. An in-depth explanation of ordinal regression is beyond the scope of this tutorial <span class="citation" data-cites="Fullerton2023 bürkner2019">(<a href="#ref-bürkner2019" role="doc-biblioref">Bürkner &amp; Vuorre, 2019</a>; but see <a href="#ref-Fullerton2023" role="doc-biblioref">Fullerton &amp; Anderson, 2021</a>)</span>. At a basic level, ordinal regression models are useful for outcome variables that are categorical in nature and have some inherent ordering (e.g., Likert scale items). To preserve this ordering, ordinal models rely on the cumulative probability distribution. Within an ordinal regression model it is assumed that there is a continuous but unobserved latent variable that determines which of <span class="math inline">k</span> ordinal responses will be selected. For example on a typical Likert scale from ‘Strongly Disagree’ to ‘Strongly Agree’, you could assume that there is a continuous, unobserved variable called ‘Agreement’. While we cannot measure Agreement directly, the ordinal response gives us some indication about where participants are on the continuous Agreement scale. <span class="math inline">k - 1</span> cutoffs are then estimated to indicate the point on the continuous Agreement scale at which your Agreement level is high enough to push you into the next ordinal category (say Agree to Strongly Agree). Coefficients in the model estimate how much different predictors change the estimated <em>continuous</em> scale (here, Agreement). Since there’s only one underlying process, there’s only one set of coefficients to work with (proportional odds assumption). In an ordered beta regression, three ordered categories are modeled: (1) exactly zero, (2) somewhere between zero and one, and (3) exactly one. In an ordered beta regression, (1) and (2) are modeled with cumulative logits, where one cutpoint is the the boundary between Exactly 0 and Between 0 and 1 and the other cutpoint is the boundary between <em>Between 0 and 1</em> and <em>Exactly 1.</em> Somewhere between 0-1 (3) is modeled as a beta regression with parameters reflecting the mean response on the logit scale. Ultimately, employing cutpoints allows for a smooth transition between the bounds and the continuous values, permitting both to be considered together rather than modeled separately as the ZOIB requires.</p>
<p>The ordered beta regression model has shown to be more efficient and less biased than some of the methods discussed <span class="citation" data-cites="kubinec2022">(<a href="#ref-kubinec2022" role="doc-biblioref">Kubinec, 2022</a>)</span> herein and has seen increasing usage across the biomedical and social sciences <span class="citation" data-cites="wilkesQuantifyingCoextinctionsEcosystem2024 martinVocalComplexitySocially2024 smithEcologicalMomentaryAssessment2024 shresthaBigFiveTraits2024 nouvianGlyphosateImpairsAversive2023">(<a href="#ref-martinVocalComplexitySocially2024" role="doc-biblioref">Martin et al., 2024</a>; <a href="#ref-nouvianGlyphosateImpairsAversive2023" role="doc-biblioref">Nouvian et al., 2023</a>; <a href="#ref-shresthaBigFiveTraits2024" role="doc-biblioref">Shrestha et al., 2024</a>; <a href="#ref-smithEcologicalMomentaryAssessment2024" role="doc-biblioref">Smith et al., 2024</a>; <a href="#ref-wilkesQuantifyingCoextinctionsEcosystem2024" role="doc-biblioref">Wilkes et al., 2024</a>)</span> because it produces only a single set of coefficient estimates in a similar manner to a standard beta regression or OLS.</p>
<section id="fitting-an-ordered-beta-regression" class="level3">
<h3 data-anchor-id="fitting-an-ordered-beta-regression">Fitting an Ordered Beta Regression</h3>
<p>To fit an ordered Beta regression in a Bayesian context we use the <code>ordbetareg</code> <span class="citation" data-cites="ordbetareg">(<a href="#ref-ordbetareg" role="doc-biblioref">Kubinec, 2023</a>)</span> package. <code>ordbetareg</code> is a front-end to the <code>brms</code> package that we described earlier; in addition to the functions available in the package, most <code>brms</code> functions and plots, including the diverse array of regression modeling options, will work with <code>ordbetareg</code> models.</p>
<p>We first load the <code>ordbetareg</code> package. You can download it from CRAN or from here: <a href="https://github.com/saudiwin/ordbetareg_pack" class="uri">https://github.com/saudiwin/ordbetareg_pack</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load ordbetareg package</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordbetareg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>ordbetareg</code> package uses <code>brms</code> on the front-end so all the arguments we used previously apply here. Instead of the <code>brm()</code> function we use <code>ordbetareg()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use ordbetareg to fit model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ord_fit_brms <span class="ot">&lt;-</span> <span class="fu">ordbetareg</span>(Accuracy <span class="sc">~</span> Fluency_dummy,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> fluency_data,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"model_beta_ordbeta"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-parameters-2" class="level2">
<h2 data-anchor-id="model-parameters-2">Model Parameters</h2>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="19" data-custom-style="FigureWithoutNote">
<div id="tbl-ordbeta-summ" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="19">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ordbeta-summ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;19</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Model summary for ordered beta model</p>
</div>
</figcaption>
<div aria-describedby="tbl-ordbeta-summ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_jble3df0beqgyiesq9ab(i, j, css_id) {
          var table = document.getElementById("tinytable_jble3df0beqgyiesq9ab");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_jble3df0beqgyiesq9ab');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_jble3df0beqgyiesq9ab(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_jble3df0beqgyiesq9ab");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 3, j: 0 }, { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 3, j: 3 },  ], css_id: 'tinytable_css_au461cskfua7heq4juix',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_6y16v1do7la21vljpfjb',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_jble3df0beqgyiesq9ab(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_au461cskfua7heq4juix, .table th.tinytable_css_au461cskfua7heq4juix { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6y16v1do7la21vljpfjb, .table th.tinytable_css_6y16v1do7la21vljpfjb { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_jble3df0beqgyiesq9ab" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.582</td>
                  <td>[-0.81, -0.357]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.309</td>
                  <td>[-0.63, 0.024]</td>
                  <td>0.967</td>
                </tr>
                <tr>
                  <td>phi</td>
                  <td>6.215</td>
                  <td>[4.586, 8.074]</td>
                  <td>1</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<section id="mean-mu-1" class="level3">
<h3 data-anchor-id="mean-mu-1">Mean (<span class="math inline">\mu</span>)</h3>
<p><a href="#tbl-ordbeta-summ" class="quarto-xref" aria-expanded="false">Table&nbsp;19</a> presents the model summary for our model. This summary looks just like the summary for our previous models, with <code>b_</code> representing the intercept and fluency contrast of <span class="math inline">\mu</span>. Here, the CrI does not include zero and the pd = .98, so we can say there is an effect of <code>Fluency</code>.</p>
</section>
<section id="dispersion-phi-1" class="level3">
<h3 data-anchor-id="dispersion-phi-1">Dispersion (<span class="math inline">\phi</span>)</h3>
<p><a href="#tbl-ordbeta-summ" class="quarto-xref" aria-expanded="false">Table&nbsp;19</a> also includes an overall phi component. When we first fit the model we did not allow fluency to vary on this parameter, but we can easily do this–seen below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>m.phi <span class="ot">&lt;-</span> <span class="fu">ordbetareg</span>(<span class="fu">bf</span>(Accuracy <span class="sc">~</span> Fluency_dummy, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                       phi <span class="sc">~</span> Fluency_dummy),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>fluency_data,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">file =</span> <span class="st">"model_beta_ordbeta_phi"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">iter =</span> <span class="dv">2000</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cores=</span><span class="dv">4</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">phi_reg=</span><span class="st">'both'</span>) <span class="co"># log phi</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the addition of the <code>phi_reg</code> argument. This argument allows us to include a model that explicitly models the dispersion parameter. Because I am modeling <span class="math inline">\phi</span> as a function of fluency, I set the argument to <code>both</code>.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="20" data-custom-style="FigureWithoutNote">
<div id="tbl-phi-ordbeta" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="20">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-phi-ordbeta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;20</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Model summary ordered beta regression with dispersion</p>
</div>
</figcaption>
<div aria-describedby="tbl-phi-ordbeta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_lss629cez6w2m2or5dhx(i, j, css_id) {
          var table = document.getElementById("tinytable_lss629cez6w2m2or5dhx");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_lss629cez6w2m2or5dhx');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_lss629cez6w2m2or5dhx(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_lss629cez6w2m2or5dhx");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 4, j: 0 }, { i: 4, j: 1 }, { i: 4, j: 2 }, { i: 4, j: 3 },  ], css_id: 'tinytable_css_60l3xkug4oj5o56dzde4',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_q2z4evq39lp5oxd4vygt',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_lss629cez6w2m2or5dhx(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_60l3xkug4oj5o56dzde4, .table th.tinytable_css_60l3xkug4oj5o56dzde4 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_q2z4evq39lp5oxd4vygt, .table th.tinytable_css_q2z4evq39lp5oxd4vygt { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_lss629cez6w2m2or5dhx" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
                <th scope="col">pd</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-0.603</td>
                  <td>[-0.815, -0.377]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_phi_Intercept</td>
                  <td>2.021</td>
                  <td>[1.585, 2.417]</td>
                  <td>1</td>
                </tr>
                <tr>
                  <td>b_Fluency_dummy1</td>
                  <td>-0.262</td>
                  <td>[-0.599, 0.084]</td>
                  <td>0.936</td>
                </tr>
                <tr>
                  <td>b_phi_Fluency_dummy1</td>
                  <td>-0.4</td>
                  <td>[-0.98, 0.175]</td>
                  <td>0.909</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>In <a href="#tbl-phi-ordbeta" class="quarto-xref" aria-expanded="false">Table&nbsp;20</a>, <code>b_phi_Fluency_dummy1</code> is close enough to 0 relative to its uncertainty, we can say that in this case there likely aren’t major differences in variance between the fluent disfluent conditions. Looking at are <span class="math inline">\mu</span> we see that the 95% CrI includes zero, indicating no effect for fluency.</p>
</div>
</section>
<section id="cutpoints" class="level3">
<h3 data-anchor-id="cutpoints">Cutpoints</h3>
<p>The model cutpoints are not reported by default, but we can access them with the R package <code>posterior</code> and the functions <code>as_draws</code> and <code>summary_draws</code>.</p>
<div class="cell FigureWithoutNote" data-after-caption-space="0pt" prefix="" data-tblnum="21" data-custom-style="FigureWithoutNote">
<div id="tbl-cutpoints" class="cell quarto-float quarto-figure quarto-figure-center" prefix="" data-after-caption-space="0pt" data-tblnum="21">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cutpoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Table&nbsp;21</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Cutzero and cutone parameter summary</p>
</div>
</figcaption>
<div aria-describedby="tbl-cutpoints-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_b9bnmoljspcecq5wd1eb(i, j, css_id) {
          var table = document.getElementById("tinytable_b9bnmoljspcecq5wd1eb");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_b9bnmoljspcecq5wd1eb');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_b9bnmoljspcecq5wd1eb(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_b9bnmoljspcecq5wd1eb");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 },  ], css_id: 'tinytable_css_fq9rknbfgse8ep44l12o',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_um2xde91mwo12bryy6vj',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_b9bnmoljspcecq5wd1eb(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_fq9rknbfgse8ep44l12o, .table th.tinytable_css_fq9rknbfgse8ep44l12o { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_um2xde91mwo12bryy6vj, .table th.tinytable_css_um2xde91mwo12bryy6vj { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_b9bnmoljspcecq5wd1eb" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col">Mean</th>
                <th scope="col">95% CrI</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>cutzero</td>
                  <td>-2.97</td>
                  <td>[-3.56, -2.43]</td>
                </tr>
                <tr>
                  <td>cutone</td>
                  <td>1.85</td>
                  <td>[1.65, 2.07]</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<div class="AfterWithoutNote" data-custom-style="AfterWithoutNote">
<p>In <a href="#tbl-cutpoints" class="quarto-xref" aria-expanded="false">Table&nbsp;21</a>, <code>cutzero</code> is the first cutpoint (the difference between 0 and continuous values) and <code>cutone</code> is the second cutpoint (the difference between the continuous values and 1). These cutpoints are on the logit scale and as such the numbers do not have a simple substantive meaning. In general, as the cutpoints increase in absolute value (away from zero), then the discrete/boundary observations are more distinct from the continuous values. This will happen if there is a clear gap or bunching in the outcome around the bounds. This type of empirical feature of the distribution may be useful to scholars if they want to study differences in how people perceive the ends of the scale versus the middle.</p>
</div>
</section>
<section id="ordered-beta-regression-model-fit" class="level3">
<h3 data-anchor-id="ordered-beta-regression-model-fit">Ordered Beta Regression Model Fit</h3>
<p>The best way to visualize model fit is to plot the full predictive distribution relative to the original outcome. Because ordered beta regression is a mixed discrete/continuous model, a separate plotting function, <code>pp_check_ordbetareg</code>, is included in the <code>ordbetareg</code> package that accurately handles the unique features of this distribution. The default plot in <code>brms</code> will collapse these two features of the outcome together, which will make the fit look worse than it actually is. The <code>ordbetareg</code> function returns a list with two plots, <code>discrete</code> and <code>continuous</code>, which can either be printed and plotted or further modified as <code>ggplot2</code> objects. This can be observed in</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$discrete</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ms_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$continuous</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ms_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The discrete plot which is a bar graph, shows that the posterior distribution accurately captures the number of different types of responses (discrete or continuous) in the data.</p>
<p>For the continuous plot shown as a density plot with one line per posterior draw, the model does a very good job at capturing the distribution.</p>
<p>Overall, it is clear from the posterior distribution plot that the ordered beta model fits the data well. To fully understand model fit, both of these plots need to be inspected as they are conceptually distinct.</p>
<section id="model-visualization" class="level4">
<h4 data-anchor-id="model-visualization">Model Visualization.</h4>
<p><code>ordbetareg</code> provides a visualization function called <code>plot_hess</code>. This function produces a plot of predicted proportions across the range of our <code>Fluency</code> factor. In <a href="#fig-heiss" class="quarto-xref" aria-expanded="false">Figure&nbsp;11</a> we get predicted proportions for Fluency across the bounded scale. Looking at the figure we can see there is much overlap between Fluent and Disfluent instructors in the middle portion (<span class="math inline">\mu</span>) . However, we do see some small differences at the zero bounds.</p>
<div class="cell FigureWithoutNote" data-custom-style="FigureWithoutNote">
<div class="cell-output-display">
<div id="fig-heiss" class="quarto-float quarto-figure quarto-figure-center" data-fignum="11" prefix="">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-heiss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="FigureTitle" data-custom-style="FigureTitle">
<p>Figure&nbsp;11</p>
</div>
<div class="Caption" data-custom-style="Caption">
<p>Heiss Plot of Predicted Probablities across the scale (0-100)</p>
</div>
</figcaption>
<div aria-describedby="fig-heiss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ms_files/figure-html/fig-heiss-1.png" class="img-fluid figure-img" width="768">
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ordered-beta-scale" class="level3">
<h3 data-anchor-id="ordered-beta-scale">Ordered Beta Scale</h3>
<p>In the <code>ordbetareg</code> function there is a <code>true_bound</code> argument. In the case where you data in not bounded between 0-1, you can use the argument to specify the bounds of the argument to fit the ordered beta regression. For example, you data might be bounded between 1 and 12. If so, you can model it as such.</p>
</section>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>The use of Beta regression in psychology, and the social sciences in general, is rare. With this tutorial, we hope to turn the tides. Beta regression models are an attractive alternative to models that impose unrealistic assumptions like normality, linearity, homoscedasticity, and unbounded data. Beyond these models, there are a diverse array of different models that can be used depending on your outcome of interest.</p>
<p>Throughout this tutorial our main aim was to help guide researchers in running analyses with proportional or percentage outcomes using Beta regression and some of it’s alternatives. In the current example, we used real data from <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span> and discussed how to fit these models in R, interpret model parameters, extract predicted probabilities and marginal effects, and visualize the results.</p>
<p>Comparing our analysis with that of @wilford2020, we demonstrated that using traditional approaches (e.g., <em>t</em>-tests) to analyze accuracy data can lead to inaccurate inferences. Although we successfully reproduced one of their key findings, our use of Beta regression and its extensions revealed important nuances in the results. With a traditional Beta regression model—which accounts for both the mean and the precision (dispersion)—we observed similar effects of instructor fluency on performance. However, the standard Beta model does not accommodate boundary values (i.e., 0s and 1s).</p>
<p>When we applied a zero-inflated Beta regression model, which explicitly accounts for structural zeros, we found no effect of fluency on the mean ($\mu$) part of the model. Instead, the effect of fluency emerged in the structural zero (inflated zero; $\alpha$) component. This pattern was consistent when using a zero-one-inflated Beta (ZOIB) model. Furthermore, we fit an ordered Beta regression model [@kubinec2022], which appropriately models the full range of values, including 0s and 1s. Here, we did not observe a reliable effect of fluency on the mean once we accounted for dispersion.</p>
<p>These analyses emphasize the importance of fitting a model that aligns with the nature of the data. The simplest and recommended approach when dealing with data that contains zeros and/or ones is to fit an ordered beta model, assuming the process is truly continuous. However, if you believe the process is distinct in nature, a ZIB or ZOIB model might be a better choice. Ultimately, this decision should be guided by theory.</p>
<p>For instance, if we believe fluency influences the structural zero part of the model, we might want to model this process separately using a ZIB or ZOIB. With the current dataset, fluency might affect specific aspects of performance (such as the likelihood of complete failure) rather than general performance levels. This effect could be due to participant disengagement during the disfluent lecture. If students fail to pay attention because of features of disfluency, they may miss relevant information, leading to a floor effect at the test. If this is the case, we would want to model this appropriately. However, if we believe fluency effects general performance levels, a model that takes in to account the entire process accounting for the zeros and ones might be appropriate.</p>
<p>In the discussion section of <span class="citation" data-cites="wilford2020">Wilford et al. (<a href="#ref-wilford2020" role="doc-biblioref">2020</a>)</span>, they were unable to offer a tenable explanation for performance differences based on instructor fluency. A model that accounts for the excess zeros in the dataset provides one testable explanation: watching a disfluent lecture may lead to lapses in attention, resulting in poorer performance in that group. These lapses, in turn, contribute to the observed differences in the fluent condition. This modeling approach opens a promising avenue for future research—one that would have remained inaccessible otherwise.</p>
<p>Not everyone will be eager to implement the techniques discussed herein. In such cases, the key question becomes: What is the least problematic approach to handling proportional data? One reasonable option is to fit multiple models tailored to the specific characteristics of your data. For example, if your data contain zeros, you might fit two models: a traditional OLS regression excluding the zeros, and a logistic model to account for the zero versus non-zero distinction. If your data contain both zeros and ones, you could fit separate models for the zeros and ones in addition to the OLS model. There are many defensible strategies to choose from depending on the context. However, we do not recommend transforming the values of your data (e.g., 0s to .01 and 1s to .99) or ignoring the properties of your data simply to fit traditional statistical models.</p>
<p>In this tutorial, we demonstrated how to analyze these models from a Bayesian perspective. While we recognize that not everyone identifies as a Bayesian, implementing these models using a Bayesian framework is relatively straightforward—it requires only a single package, lowering the barrier to entry. For those who prefer frequentist analyses, several R packages are available. For standard beta regression, the <code>betareg</code> package <span class="citation" data-cites="betareg">(<a href="#ref-betareg" role="doc-biblioref">Cribari-Neto &amp; Zeileis, 2010</a>)</span> is a solid option, while more complex models such as zero-inflated and ordered beta regressions can be implemented using <code>glmmTMB</code> [<span class="citation" data-cites="glmmTMB">Brooks et al. (<a href="#ref-glmmTMB" role="doc-biblioref">2017</a>)</span>]. For fitting zero-one models, there is a new implementation in <span class="citation" data-cites="betareg">Cribari-Neto and Zeileis (<a href="#ref-betareg" role="doc-biblioref">2010</a>)</span>, that allows you to model these types of data.</p>
<section id="conclusion" class="level2">
<h2 data-anchor-id="conclusion">Conclusion</h2>
<p>Overall, this tutorial emphasizes the importance of modeling the data you have. Although the example provided is relatively simple (a one-factor model with two levels), we hope it demonstrates that even with a basic dataset, there is much nuance in interpretation and inference. Properly modeling your data can lead to deeper insights, far beyond what traditional measures might offer. With the tools introduced in this tutorial, researchers now have the means to analyze their data effectively, uncover patterns, make accurate predictions, and support their findings with robust statistical evidence. By applying these modeling techniques, researchers can improve the validity and reliability of their studies, ultimately leading to more informed decisions and advancements in their respective fields.</p>
</section>
<section id="references" class="level2">
<h2 data-anchor-id="references">References</h2>
<!-- References will auto-populate in the refs div below -->
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-margeffects2024" class="csl-entry" role="listitem">
Arel-Bundock, V., Greifer, N., &amp; Heiss, A. (2024). How to interpret statistical models using <span class="nocase">marginaleffects</span> for <span>R</span> and <span>Python</span>. <em>Journal of Statistical Software</em>, <em>111</em>(9), 1–32. <a href="https://doi.org/10.18637/jss.v111.i09">https://doi.org/10.18637/jss.v111.i09</a>
</div>
<div id="ref-bartlett1936" class="csl-entry" role="listitem">
Bartlett, M. S. (1936). The Square Root Transformation in Analysis of Variance. <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>, <em>3</em>(1), 68–78. <a href="https://doi.org/10.2307/2983678">https://doi.org/10.2307/2983678</a>
</div>
<div id="ref-bendixen2023" class="csl-entry" role="listitem">
Bendixen, T., &amp; Purzycki, B. G. (2023). Cognitive and cultural models in psychological science: A tutorial on modeling free-list data as a dependent variable in Bayesian regression. <em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000553">https://doi.org/10.1037/met0000553</a>
</div>
<div id="ref-glmmTMB" class="csl-entry" role="listitem">
Brooks, M. E., Kristensen, K., van, K. J., Magnusson, A., Berg, C. W., Nielsen, A., Skaug, H. J., Maechler, M., &amp; Bolker, B. M. (2017). <em><span></span>glmmTMB<span></span> balances speed and flexibility among packages for zero-inflated generalized linear mixed modeling</em>. <em>9</em>. <a href="https://doi.org/10.32614/RJ-2017-066">https://doi.org/10.32614/RJ-2017-066</a>
</div>
<div id="ref-brms" class="csl-entry" role="listitem">
Bürkner, P.-C. (2017). <em><span></span>Brms<span></span>: An <span></span>r<span></span> package for <span></span>bayesian<span></span> multilevel models using <span></span>stan<span></span></em>. <em>80</em>. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>
</div>
<div id="ref-bürkner2019" class="csl-entry" role="listitem">
Bürkner, P.-C., &amp; Vuorre, M. (2019). Ordinal Regression Models in Psychology: A Tutorial. <em>Advances in Methods and Practices in Psychological Science</em>, <em>2</em>(1), 77–101. <a href="https://doi.org/10.1177/2515245918823199">https://doi.org/10.1177/2515245918823199</a>
</div>
<div id="ref-carpenter2013" class="csl-entry" role="listitem">
Carpenter, S. K., Wilford, M. M., Kornell, N., &amp; Mullaney, K. M. (2013). Appearances can be deceiving: instructor fluency increases perceptions of learning without increasing actual learning. <em>Psychonomic Bulletin &amp; Review</em>, <em>20</em>(6), 1350–1356. <a href="https://doi.org/10.3758/s13423-013-0442-z">https://doi.org/10.3758/s13423-013-0442-z</a>
</div>
<div id="ref-coretta2025bayesian" class="csl-entry" role="listitem">
Coretta, S., &amp; Bürkner, P.-C. (2025). <em>Bayesian beta regressions with brms in r: A tutorial for phoneticians</em>. <a href="https://doi.org/10.31219/osf.io/f9rqg_v1" class="uri">https://doi.org/10.31219/osf.io/f9rqg_v1</a>.
</div>
<div id="ref-betareg" class="csl-entry" role="listitem">
Cribari-Neto, F., &amp; Zeileis, A. (2010). <em>Beta regression in <span></span>r<span></span></em>. <em>34</em>. <a href="https://doi.org/10.18637/jss.v034.i02">https://doi.org/10.18637/jss.v034.i02</a>
</div>
<div id="ref-nix" class="csl-entry" role="listitem">
Dolstra, E., &amp; contributors, T. N. (2006). <em>Nix</em> [Computer software]. <a href="https://nixos.org/">https://nixos.org/</a>
</div>
<div id="ref-ferrari2004" class="csl-entry" role="listitem">
Ferrari, S., &amp; Cribari-Neto, F. (2004). Beta Regression for Modelling Rates and Proportions. <em>Journal of Applied Statistics</em>, <em>31</em>(7), 799–815. <a href="https://doi.org/10.1080/0266476042000214501">https://doi.org/10.1080/0266476042000214501</a>
</div>
<div id="ref-Fullerton2023" class="csl-entry" role="listitem">
Fullerton, A. S., &amp; Anderson, K. F. (2021). Ordered Regression Models: a Tutorial. <em>Prevention Science</em>, <em>24</em>(3), 431–443. <a href="https://doi.org/10.1007/s11121-021-01302-y">https://doi.org/10.1007/s11121-021-01302-y</a>
</div>
<div id="ref-cmdstanr" class="csl-entry" role="listitem">
Gabry, J., Češnovar, R., Johnson, A., &amp; Bronder, S. (2024). <em>Cmdstanr: R interface to ’CmdStan’</em>. <a href="https://mc-stan.org/cmdstanr/">https://mc-stan.org/cmdstanr/</a>
</div>
<div id="ref-gelman2013bayesian" class="csl-entry" role="listitem">
Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). <em>Bayesian data analysis</em> (Third). CRC. <a href="https://stat.columbia.edu/~gelman/book/">https://stat.columbia.edu/~gelman/book/</a>
</div>
<div id="ref-heiss2021" class="csl-entry" role="listitem">
Heiss, A. (2021). <em>A guide to modeling proportions with bayesian beta and zero-inflated beta regression models</em>. <a href="http://dx.doi.org/10.59350/7p1a4-0tw75">http://dx.doi.org/10.59350/7p1a4-0tw75</a>
</div>
<div id="ref-bayes_rules" class="csl-entry" role="listitem">
Johnson, A., Ott, M., &amp; Dogucu, M. (n.d.). <em>Bayes rules!: An introduction to applied bayesian modeling</em>. Routledge &amp; CRC Press.
</div>
<div id="ref-kong2016" class="csl-entry" role="listitem">
Kong, E. J., &amp; Edwards, J. (2016). Individual differences in categorical perception of speech: Cue weighting and executive function. <em>Journal of Phonetics</em>, <em>59</em>, 40–57. <a href="https://doi.org/10.1016/j.wocn.2016.08.006">https://doi.org/10.1016/j.wocn.2016.08.006</a>
</div>
<div id="ref-kubinec2022" class="csl-entry" role="listitem">
Kubinec, R. (2022). Ordered Beta Regression: A Parsimonious, Well-Fitting Model for Continuous Data with Lower and Upper Bounds. <em>Political Analysis</em>, <em>31</em>(4), 519–536. <a href="https://doi.org/10.1017/pan.2022.20">https://doi.org/10.1017/pan.2022.20</a>
</div>
<div id="ref-ordbetareg" class="csl-entry" role="listitem">
Kubinec, R. (2023). <em>Ordbetareg: Ordered beta regression models with ’brms’</em>. <a href="https://CRAN.R-project.org/package=ordbetareg">https://CRAN.R-project.org/package=ordbetareg</a>
</div>
<div id="ref-ggeffects-2" class="csl-entry" role="listitem">
Lüdecke, D. (2018). <em>Ggeffects: Tidy data frames of marginal effects from regression models.</em> <em>3</em>, 772. <a href="https://doi.org/10.21105/joss.00772">https://doi.org/10.21105/joss.00772</a>
</div>
<div id="ref-easystats" class="csl-entry" role="listitem">
Lüdecke, D., Ben-Shachar, M. S., Patil, I., Wiernik, B. M., Bacher, E., Thériault, R., &amp; Makowski, D. (2022). <em>Easystats: Framework for easy statistical modeling, visualization, and reporting</em>. <a href="https://easystats.github.io/easystats/">https://easystats.github.io/easystats/</a>
</div>
<div id="ref-makowski2019a" class="csl-entry" role="listitem">
Makowski, D., Ben-Shachar, M. S., Chen, S. H. A., &amp; Lüdecke, D. (2019). Indices of effect existence and significance in the bayesian framework. <em>Frontiers in Psychology</em>, <em>10</em>. <a href="https://doi.org/10.3389/fpsyg.2019.02767">https://doi.org/10.3389/fpsyg.2019.02767</a>
</div>
<div id="ref-makowski2019" class="csl-entry" role="listitem">
Makowski, D., Ben-Shachar, M., &amp; Lüdecke, D. (2019). bayestestR: Describing effects and their uncertainty, existence and significance within the bayesian framework. <em>Journal of Open Source Software</em>, <em>4</em>(40), 1541. <a href="https://doi.org/10.21105/joss.01541">https://doi.org/10.21105/joss.01541</a>
</div>
<div id="ref-martinVocalComplexitySocially2024" class="csl-entry" role="listitem">
Martin, K., Cornero, F. M., Clayton, N. S., Adam, O., Obin, N., &amp; Dufour, V. (2024). Vocal complexity in a socially complex corvid: Gradation, diversity and lack of common call repertoire in male rooks. <em>Royal Society Open Science</em>, <em>11</em>(1), 231713. <a href="https://doi.org/10.1098/rsos.231713">https://doi.org/10.1098/rsos.231713</a>
</div>
<div id="ref-mcelreath2020statistical" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: A bayesian course with examples in r and STAN</em> (2nd ed.). Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780429029608">https://doi.org/10.1201/9780429029608</a>
</div>
<div id="ref-nelder1972" class="csl-entry" role="listitem">
Nelder, J. A., &amp; Wedderburn, R. W. M. (1972). Generalized linear models. <em>Journal of the Royal Statistical Society. Series A (General)</em>, <em>135</em>(3), 370–384. <a href="https://doi.org/10.2307/2344614">https://doi.org/10.2307/2344614</a>
</div>
<div id="ref-nouvianGlyphosateImpairsAversive2023" class="csl-entry" role="listitem">
Nouvian, M., Foster, J. J., &amp; Weidenmüller, A. (2023). Glyphosate impairs aversive learning in bumblebees. <em>Science of The Total Environment</em>, <em>898</em>, 165527. <a href="https://www.sciencedirect.com/science/article/pii/S0048969723041505">https://www.sciencedirect.com/science/article/pii/S0048969723041505</a>
</div>
<div id="ref-paolino2001" class="csl-entry" role="listitem">
Paolino, P. (2001). Maximum Likelihood Estimation of Models with Beta-Distributed Dependent Variables. <em>Political Analysis</em>, <em>9</em>(4), 325–346. <a href="https://doi.org/10.1093/oxfordjournals.pan.a004873">https://doi.org/10.1093/oxfordjournals.pan.a004873</a>
</div>
<div id="ref-R" class="csl-entry" role="listitem">
R Core Team. (2024). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>
</div>
<div id="ref-rix" class="csl-entry" role="listitem">
Rodrigues, B., &amp; Baumann, P. (2025). <em>Rix: Reproducible data science environments with ’nix’</em>. <a href="https://docs.ropensci.org/rix/">https://docs.ropensci.org/rix/</a>
</div>
<div id="ref-shresthaBigFiveTraits2024" class="csl-entry" role="listitem">
Shrestha, S., Sigdel, K., Pokharel, M., &amp; Columbus, S. (2024). Big five traits predict between- and within-person variation in loneliness. <em>European Journal of Personality</em>, 08902070241239834. <a href="https://doi.org/10.1177/08902070241239834">https://doi.org/10.1177/08902070241239834</a>
</div>
<div id="ref-sladekova2024unicorns" class="csl-entry" role="listitem">
Sladekova, M., &amp; Field, A. P. (2024). <em>In search of unicorns: Assessing statistical assumptions in real psychology datasets</em>. <a href="https://doi.org/10.31234/osf.io/4rznt">https://doi.org/10.31234/osf.io/4rznt</a>
</div>
<div id="ref-smithEcologicalMomentaryAssessment2024" class="csl-entry" role="listitem">
Smith, K. E., Panlilio, L. V., Feldman, J. D., Grundmann, O., Dunn, K. E., McCurdy, C. R., Garcia-Romeu, A., &amp; Epstein, D. H. (2024). Ecological momentary assessment of self-reported kratom use, effects, and motivations among US adults. <em>JAMA Network Open</em>, <em>7</em>(1), e2353401. <a href="https://doi.org/10.1001/jamanetworkopen.2023.53401">https://doi.org/10.1001/jamanetworkopen.2023.53401</a>
</div>
<div id="ref-stan2023" class="csl-entry" role="listitem">
Team, S. D. (2023). <em>Stan: A probabilistic programming language</em>. <a href="https://mc-stan.org">https://mc-stan.org</a>
</div>
<div id="ref-toftness2017" class="csl-entry" role="listitem">
Toftness, A. R., Carpenter, S. K., Geller, J., Lauber, S., Johnson, M., &amp; Armstrong, P. I. (2017). Instructor fluency leads to higher confidence in learning, but not better learning. <em>Metacognition and Learning</em>, <em>13</em>(1), 1–14. <a href="https://doi.org/10.1007/s11409-017-9175-0">https://doi.org/10.1007/s11409-017-9175-0</a>
</div>
<div id="ref-vuorre2019" class="csl-entry" role="listitem">
Vuorre, M. (2019, February 18). <em>How to Analyze Visual Analog (Slider) Scale Data?</em> <a href="https://vuorre.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models">https://vuorre.com/posts/2019-02-18-analyze-analog-scale-ratings-with-zero-one-inflated-beta-models</a>
</div>
<div id="ref-wilford2020" class="csl-entry" role="listitem">
Wilford, M. M., Kurpad, N., Platt, M., &amp; Weinstein-Jones, Y. (2020). Lecturer fluency can impact students’ judgments of learning and actual learning performance. <em>Applied Cognitive Psychology</em>, <em>34</em>(6), 1444–1456. <a href="https://doi.org/10.1002/acp.3724">https://doi.org/10.1002/acp.3724</a>
</div>
<div id="ref-wilkesQuantifyingCoextinctionsEcosystem2024" class="csl-entry" role="listitem">
Wilkes, L. N., Barner, A. K., Keyes, A. A., Morton, D., Byrnes, J. E. K., &amp; Dee, L. E. (2024). Quantifying co‐extinctions and ecosystem service vulnerability in coastal ecosystems experiencing climate warming. <em>Global Change Biology</em>, <em>30</em>(7), e17422. <a href="https://doi.org/10.1111/gcb.17422">https://doi.org/10.1111/gcb.17422</a>
</div>
<div id="ref-witherby2022" class="csl-entry" role="listitem">
Witherby, A. E., &amp; Carpenter, S. K. (2022). The impact of lecture fluency and technology fluency on students<span>’</span> online learning and evaluations of instructors. <em>Journal of Applied Research in Memory and Cognition</em>, <em>11</em>(4), 500–509. <a href="https://doi.org/10.1037/mac0000003">https://doi.org/10.1037/mac0000003</a>
</div>
</div>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>See an example of the fluent video here: <a href="https://osf.io/hwzuk" class="uri">https://osf.io/hwzuk</a>. See an example of the disfluent video here: <a href="https://osf.io/ra7be" class="uri">https://osf.io/ra7be</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We have chain diagnostics included like Rhat and ESS which indicates how the MCMC sampling performed. For more information check out Gelman et al., 2013; Kruschke, 2014; McElreath, 2020)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><code>ggeffects</code> is another great package to extract marginal effects and plot <span class="citation" data-cites="ggeffects-2">(<a href="#ref-ggeffects-2" role="doc-biblioref">Lüdecke, 2018</a>)</span><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In cases where there are large amounts of 1s but no zeros you can fit a one-inflated model. Currently you can do so with the <code>gamlss</code> package in R<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>